export const assets: Record<string, string> = {
  "uu.ts": "Ly8gdXU6IGEgc2V0IG9mIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBtb2Rlcm4gd2ViIFVJCi8vIGhhc2g6IGE2YmM4OGZkZGZkZGUwMzM5ZTc3NGFlNDYzNDRjNTBlZDlhMWU1Y2VmNTExZWQyNjY5ODZiNWFmMDhlODYxOTcKLy8gUGxlYXNlIGRvIG5vdCBtb2RpZnkgdGhpcyBmaWxlIGRpcmVjdGx5LiBVc2UgdGhlIGZvbGxvd2luZyBjb21tYW5kIHRvIHVwZGF0ZSB0aGlzIGZpbGUgb24gYSBkZW5vIGVudmlyb25tZW50OgovLyBkZW5vIHJ1biAtQSAtLXJlbG9hZCBqc3I6QHRpbWVwcC91dS9pbnN0YWxsCgppbXBvcnQgKiBhcyB0dSBmcm9tICcuL3R1LnRzJwpleHBvcnQgKiBmcm9tICcuL3R1LnRzJwoKZXhwb3J0IGZ1bmN0aW9uIHRyaWdnZXJEb3dubG9hZChibG9iOiBCbG9iLCBmaWxlbmFtZTogc3RyaW5nKSB7CiAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpCiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpCiAgICBhLmhyZWYgPSB1cmwKICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKQogICAgYS5jbGljaygpCiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpCn0KCmV4cG9ydCBmdW5jdGlvbiBkZXJpdmVkVXJsKG9sZFVybDogc3RyaW5nLCBwYXJhbXNUb0FkZDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgcGFyYW1zVG9SZW1vdmU/OiBSZWdFeHApIHsKICAgIGNvbnN0IHVybCA9IG5ldyBVUkwob2xkVXJsKQogICAgaWYgKHBhcmFtc1RvUmVtb3ZlKSB7CiAgICAgICAgY29uc3Qga2V5cyA9IFsuLi51cmwuc2VhcmNoUGFyYW1zLmtleXMoKV0KICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7CiAgICAgICAgICAgIGlmIChwYXJhbXNUb1JlbW92ZS50ZXN0KGtleSkpIHsKICAgICAgICAgICAgICAgIHVybC5zZWFyY2hQYXJhbXMuZGVsZXRlKGtleSkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHBhcmFtc1RvQWRkKSkgewogICAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KGtleSwgdmFsdWUpCiAgICB9CiAgICByZXR1cm4gdXJsLnRvU3RyaW5nKCkKfQoKZXhwb3J0IGZ1bmN0aW9uIGRlcml2ZWRDdXJyZW50VXJsKHBhcmFtc1RvQWRkOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBwYXJhbXNUb1JlbW92ZT86IFJlZ0V4cCkgewogICAgcmV0dXJuIGRlcml2ZWRVcmwod2luZG93LmxvY2F0aW9uLmhyZWYsIHBhcmFtc1RvQWRkLCBwYXJhbXNUb1JlbW92ZSkKfQoKZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQ8SyBleHRlbmRzIGtleW9mIEhUTUxFbGVtZW50VGFnTmFtZU1hcD4ocGFyZW50OiBFbGVtZW50IHwgbnVsbCwgdGFnTmFtZTogSywgY2xhc3Nlczogc3RyaW5nW10gPSBbXSwgdGV4dD86IHN0cmluZywgc3R5bGU6IFBhcnRpYWw8Q1NTU3R5bGVEZWNsYXJhdGlvbj4gPSB7fSkgewogICAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSkKICAgIGUuY2xhc3NMaXN0LmFkZCguLi5jbGFzc2VzKQogICAgaWYgKHBhcmVudCkgcGFyZW50LmFwcGVuZENoaWxkKGUpCiAgICBpZiAodGV4dCkgZS50ZXh0Q29udGVudCA9IHRleHQKICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHN0eWxlKSkgewogICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGUuc3R5bGVba2V5IGFzIGFueV0gPSB2YWx1ZSBhcyBzdHJpbmcKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gZQp9CgpleHBvcnQgZnVuY3Rpb24gZm9yRWFjaFRhYmxlQ2VsbCh0YWJsZTogSFRNTFRhYmxlRWxlbWVudCwgY2FsbGJhY2s6IChjZWxsOiBIVE1MVGFibGVDZWxsRWxlbWVudCwgcm93OiBudW1iZXIsIGNvbDogbnVtYmVyKSA9PiB2b2lkKSB7CiAgICAvLyByb3c6IDAgaXMgaGVhZGVyLCAxIGlzIGZpcnN0IHJvdwogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YWJsZS5yb3dzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qgcm93ID0gdGFibGUucm93c1tpXQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgcm93LmNlbGxzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSByb3cuY2VsbHNbal0KICAgICAgICAgICAgY2FsbGJhY2soY2VsbCwgaSwgaikKICAgICAgICB9CiAgICB9Cn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxsQXN5bmNGdW5jdGlvbldpdGhQcm9ncmVzczxUPihmbjogKCkgPT4gUHJvbWlzZTxUPikgewogICAgY29uc3QgZGlhbG9nID0gY3JlYXRlRWxlbWVudChkb2N1bWVudC5ib2R5LCAnZGlhbG9nJywgW10pCiAgICBjb25zdCBkYyA9IGNyZWF0ZUVsZW1lbnQoZGlhbG9nLCAnZGl2JywgW10pCiAgICBkYy5zdHlsZS50ZXh0QWxpZ24gPSAiY2VudGVyIgogICAgY3JlYXRlRWxlbWVudChkYywgJ2g0JywgWydtLTInXSwgJ1BsZWFzZSB3YWl0Li4uJykKICAgIC8vIHNob3cgYSBjZW50ZXJlZCBzcGlubmVyCiAgICBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgWydzcGlubmVyLWJvcmRlcicsICd0ZXh0LXByaW1hcnknXSwgJycpCiAgICBkaWFsb2cuc2hvd01vZGFsKCkKICAgIHRyeSB7CiAgICAgICAgY29uc3QgciA9IGF3YWl0IGZuKCkKICAgICAgICBkaWFsb2cuY2xvc2UoKQogICAgICAgIGRpYWxvZy5yZW1vdmUoKQogICAgICAgIHJldHVybiByCiAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgZGlhbG9nLmNsb3NlKCkKICAgICAgICBkaWFsb2cucmVtb3ZlKCkKICAgICAgICB0aHJvdyBlCiAgICB9Cn0KCi8vIHNob3cgaW5mb3JtYXRpb24gZGlhbG9nLCBjb250ZW50IGlzIG5vcm1hbCB0ZXh0LCBkaWFsb2cgbm8gbG9uZ2VyIGZpeCBoZWlnaHQKZXhwb3J0IGZ1bmN0aW9uIHNob3dJbmZvKHRpdGxlOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZykgewogICAgY29uc3QgZGlhbG9nID0gY3JlYXRlRWxlbWVudChkb2N1bWVudC5ib2R5LCAnZGlhbG9nJywgW10pCgogICAgY29uc3QgZGMgPSBjcmVhdGVFbGVtZW50KGRpYWxvZywgJ2RpdicsIFtdKQoKICAgIGNvbnN0IGhlYWRlciA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbXSkKICAgIGhlYWRlci5zdHlsZS50ZXh0QWxpZ24gPSAiY2VudGVyIgogICAgY3JlYXRlRWxlbWVudChoZWFkZXIsICdoMicsIFtdLCB0aXRsZSkKICAgIGNyZWF0ZUVsZW1lbnQoZGMsICdocicsIFtdKQoKICAgIGNvbnN0IG1haW4gPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pCiAgICBtYWluLnN0eWxlLm1heFdpZHRoID0gIjgwMHB4IgogICAgY29uc3QgaCA9IHR1LnNlZ21lbnRCeVJlZ2V4KGNvbnRlbnQsIFtbL2Vycm9yOi9pZywgJ3JlZCddXSkKICAgIC8vIG1haW4uYXBwZW5kQ2hpbGQoaCkKCiAgICBjcmVhdGVFbGVtZW50KGRjLCAnaHInLCBbXSkKCiAgICBjb25zdCBmb290ZXIgPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgWydkLWZsZXgnLCAnanVzdGlmeS1jb250ZW50LWNlbnRlciddKQogICAgY29uc3QgY2xvc2VCdXR0b24gPSBjcmVhdGVFbGVtZW50KGZvb3RlciwgJ2J1dHRvbicsIFsnYnRuJywgJ2J0bi1wcmltYXJ5J10sICdDbG9zZScpCiAgICBjbG9zZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gewogICAgICAgIGRpYWxvZy5jbG9zZSgpCiAgICAgICAgZGlhbG9nLnJlbW92ZSgpCiAgICB9CiAgICBkaWFsb2cuc2hvd01vZGFsKCkKICAgIHJldHVybiBkaWFsb2cKfQoKZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodFRleHQodGV4dDogc3RyaW5nLCBydWxlczogW1JlZ0V4cCwgc3RyaW5nXVtdKSB7CiAgICBjb25zdCBwYXJ0cyA9IHR1LnNlZ21lbnRCeVJlZ2V4KHRleHQsIHJ1bGVzKQogICAgcmV0dXJuIHBhcnRzLm1hcChwYXJ0ID0+IHsKICAgICAgICBjb25zdCBzcGFuID0gY3JlYXRlRWxlbWVudChudWxsLCAnc3BhbicsIFtdLCBwYXJ0LmNvbnRlbnQpCiAgICAgICAgaWYgKHBhcnQuY2F0ZWdvcnkpIHsKICAgICAgICAgICAgc3Bhbi5zdHlsZS5jb2xvciA9IHBhcnQuY2F0ZWdvcnkKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNwYW4KICAgIH0pCn0KCmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVKc29uVmlldyhjb250ZW50OiBzdHJpbmcpIHsKICAgIGNvbnN0IHBhcnRzID0gdHUuc2VnbWVudEpzb24oY29udGVudCkKICAgIGNvbnN0IHByZSA9IGNyZWF0ZUVsZW1lbnQobnVsbCwgJ3ByZScsIFtdKQoKICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0cykgewogICAgICAgIGNvbnN0IHNwYW4gPSBjcmVhdGVFbGVtZW50KHByZSwgJ3NwYW4nKQogICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBwYXJ0LmNvbnRlbnQKICAgICAgICBzd2l0Y2ggKHBhcnQuY2F0ZWdvcnkpIHsKICAgICAgICAgICAgY2FzZSAna2V5Jzogc3Bhbi5zdHlsZS5jb2xvciA9ICdibHVlJzsgYnJlYWsKICAgICAgICAgICAgLy8gY2FzZSAnc3RyaW5nJzogc3Bhbi5zdHlsZS5jb2xvciA9ICdwdXJwbGUnOyBicmVhawogICAgICAgICAgICBjYXNlICdudW1iZXInOiBzcGFuLnN0eWxlLmNvbG9yID0gJyNmNDM5ZTYnOyBicmVhawogICAgICAgICAgICBjYXNlICd0cnVlJzogc3Bhbi5zdHlsZS5jb2xvciA9ICdncmVlbic7IGJyZWFrCiAgICAgICAgICAgIGNhc2UgJ2ZhbHNlJzogc3Bhbi5zdHlsZS5jb2xvciA9ICdyZWQnOyBicmVhawogICAgICAgICAgICBjYXNlICdudWxsJzogc3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAneWVsbG93JzsgYnJlYWsKICAgICAgICAgICAgY2FzZSAncHVuY3R1YXRpb24nOiBzcGFuLnN0eWxlLmZvbnRXZWlnaHQgPSAiODAwIjsgYnJlYWsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHByZQp9CgpleHBvcnQgZnVuY3Rpb24gc2hvd0xhcmdlSnNvblJlc3VsdCh0aXRsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpIHsKICAgIGNvbnN0IGRpYWxvZyA9IGNyZWF0ZUVsZW1lbnQoZG9jdW1lbnQuYm9keSwgJ2RpYWxvZycsIFtdKQogICAgZGlhbG9nLnN0eWxlLndpZHRoID0gIjgwdnciOyAgCiAgICBkaWFsb2cuc3R5bGUuaGVpZ2h0ID0gIjgwdmgiOyAKCiAgICBjb25zdCBkYyA9IGNyZWF0ZUVsZW1lbnQoZGlhbG9nLCAnZGl2JywgW10pCiAgICBkYy5zdHlsZS53aWR0aCA9ICIxMDAlIjsgICAvLyDlrr3luqYxMDAlCiAgICBkYy5zdHlsZS5oZWlnaHQgPSAiMTAwJSI7ICAvLyDpq5jluqYxMDAlCiAgICBkYy5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOwogICAgZGMuc3R5bGUuYWxpZ25JdGVtcyA9ICJjZW50ZXIiOwogICAgZGMuc3R5bGUuZmxleERpcmVjdGlvbiA9ICJjb2x1bW4iOwoKICAgIGNvbnN0IGhlYWRlciA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbXSkKICAgIGNyZWF0ZUVsZW1lbnQoaGVhZGVyLCAnaDInLCBbXSwgdGl0bGUpCgogICAgY29uc3QgbWFpbiA9IGNyZWF0ZUVsZW1lbnQoZGMsICdwcmUnLCBbXSkKICAgIGNvbnN0IHNwYW5zID0gaGlnaGxpZ2h0VGV4dChjb250ZW50LCBbWy8iW14iXSsiOi9nLCAnYmx1ZSddLCBbL+KAplswLTldKyBtb3JlIChjaGFyc3xpdGVtcynigKYvZywgJ3JlZCddXSkKICAgIG1haW4uYXBwZW5kKC4uLnNwYW5zKQogICAgbWFpbi5zdHlsZS5mbGV4R3JvdyA9ICIxIjsgICAvLyDorqkgdGV4dGFyZWEg5Y2g5ruh5Ymp5L2Z56m66Ze0CiAgICBtYWluLnN0eWxlLndpZHRoID0gIjEwMCUiOyAgIC8vIOWuveW6pjEwMCUKCiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoZGMsICdidXR0b24nLCBbJ2J0bicsICdidG4tcHJpbWFyeSddLCAnQ2xvc2UnKQogICAgY2xvc2VCdXR0b24ub25jbGljayA9ICgpID0+IHsKICAgICAgICBkaWFsb2cuY2xvc2UoKQogICAgICAgIGRpYWxvZy5yZW1vdmUoKQogICAgfQogICAgZGlhbG9nLnNob3dNb2RhbCgpCiAgICByZXR1cm4gZGlhbG9nCn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaG93SW5wdXREaWFsb2codGl0bGU6IHN0cmluZywgcGxhY2Vob2xkZXI6IHN0cmluZywgaW5pdGlhbFZhbHVlPzogc3RyaW5nKSB7CiAgICBjb25zdCBkaWFsb2cgPSBjcmVhdGVFbGVtZW50KGRvY3VtZW50LmJvZHksICdkaWFsb2cnLCBbXSwgJycsIHt3aWR0aDogJzQwMHB4J30pCiAgICBjb25zdCBkYyA9IGNyZWF0ZUVsZW1lbnQoZGlhbG9nLCAnZGl2JywgWydkLWZsZXgnLCAnZmxleC1jb2x1bW4nXSkKICAgIGNvbnN0IGhlYWRlciA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbXSkKICAgIGNyZWF0ZUVsZW1lbnQoaGVhZGVyLCAnaDInLCBbXSwgdGl0bGUpCiAgICBjb25zdCBpbnB1dCA9IGNyZWF0ZUVsZW1lbnQoZGMsICdpbnB1dCcsIFsnZm9ybS1jb250cm9sJ10sICcnLCB7bWFyZ2luVG9wOiAnMTBweCd9KQogICAgaW5wdXQucGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlcgogICAgaWYgKGluaXRpYWxWYWx1ZSkgaW5wdXQudmFsdWUgPSBpbml0aWFsVmFsdWUKICAgIGNvbnN0IGZvb3RlciA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbJ2QtZmxleCcsICdqdXN0aWZ5LWNvbnRlbnQtZW5kJywgJ210LTInXSkKICAgIGNvbnN0IG9rQnRuID0gY3JlYXRlRWxlbWVudChmb290ZXIsICdidXR0b24nLCBbJ2J0bicsICdidG4tcHJpbWFyeSddLCAnT0snKQogICAgY29uc3QgY2FuY2VsQnRuID0gY3JlYXRlRWxlbWVudChmb290ZXIsICdidXR0b24nLCBbJ2J0bicsICdidG4tc2Vjb25kYXJ5JywgJ21zLTInXSwgJ0NhbmNlbCcpCgogICAgbGV0IHJlc29sdmVyOiAoKHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQpID0+IHZvaWQpCiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPigocmVzb2x2ZSkgPT4gewogICAgICAgIHJlc29sdmVyID0gcmVzb2x2ZQogICAgfSkKCiAgICBva0J0bi5vbmNsaWNrID0gKCkgPT4gewogICAgICAgIGRpYWxvZy5jbG9zZSgpCiAgICAgICAgZGlhbG9nLnJlbW92ZSgpCiAgICAgICAgcmVzb2x2ZXIoaW5wdXQudmFsdWUpCiAgICB9CiAgICAKICAgIGNhbmNlbEJ0bi5vbmNsaWNrID0gKCkgPT4gewogICAgICAgIGRpYWxvZy5jbG9zZSgpCiAgICAgICAgZGlhbG9nLnJlbW92ZSgpCiAgICAgICAgcmVzb2x2ZXIodW5kZWZpbmVkKQogICAgfQoKICAgIC8vIGhhbmRsZSBlc2Mga2V5IHRvIGNsb3NlIHRoZSBkaWFsb2cKICAgIGRpYWxvZy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHsKICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7CiAgICAgICAgICAgIGRpYWxvZy5jbG9zZSgpCiAgICAgICAgICAgIGRpYWxvZy5yZW1vdmUoKQogICAgICAgICAgICByZXNvbHZlcih1bmRlZmluZWQpCiAgICAgICAgfQogICAgfSkKCiAgICBkaWFsb2cuc2hvd01vZGFsKCkKICAgIHJldHVybiBwcm9taXNlCn0KCmV4cG9ydCB0eXBlIFNlbGVjdE9wdGlvbiA9IHsKICAgIHNpbmdsZVNlbGVjdDogYm9vbGVhbgogICAgcHJlc2VydmVPcmRlcjogYm9vbGVhbgogICAgaW5pdGlhbFNlbGVjdGlvbjogc3RyaW5nW10KCiAgICAvLyByZXR1cm4gYG5ld1NlbGVjdGlvbmAgaWYgdGhlIG5ldyBzZWxlY3Rpb24gaXMgdmFsaWQKICAgIC8vIG90aGVyd2lzZSwgcmV0dXJuIGEgc2VsZWN0aW9uIGlmIGNoZWNrZXIgY2FuIGZpeCBpbnZhbGlkIHNlbGVjdGlvbgogICAgLy8gb3RoZXJ3aXNlLCByZXR1cm4gYW4gZXJyb3IgbWVzc2FnZQogICAgY2hlY2tlcjogKG9sZFNlbGVjdGlvbjogc3RyaW5nW10sIG5ld1NlbGVjdGlvbjogc3RyaW5nW10pID0+IHN0cmluZ1tdIHwgc3RyaW5nCn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaG93U2VsZWN0aW9uKHRpdGxlOiBzdHJpbmcsIGRhdGE6IHN0cmluZ1tdLCBvcHRpb25zOiBQYXJ0aWFsPFNlbGVjdE9wdGlvbj4pIHsKICAgIGNvbnN0IGRpYWxvZyA9IGNyZWF0ZUVsZW1lbnQoZG9jdW1lbnQuYm9keSwgJ2RpYWxvZycsIFtdLCAnJywge3dpZHRoOiAnODB2dyd9KQogICAgY29uc3QgZGMgPSBjcmVhdGVFbGVtZW50KGRpYWxvZywgJ2RpdicsIFsnZC1mbGV4JywgJ2ZsZXgtY29sdW1uJ10pCiAgICBjb25zdCBoZWFkZXIgPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pCiAgICBjcmVhdGVFbGVtZW50KGhlYWRlciwgJ2gyJywgW10sIHRpdGxlKQogICAgY29uc3Qgc2VsZWN0ZWRDb250ZW50ID0gY3JlYXRlRWxlbWVudChkYywgJ2RpdicsIFtdKQogICAgLy8gY3JlYXRlRWxlbWVudChkYywgJ2hyJywgWyd3LTEwMCddKQogICAgCiAgICAvLyBmaWx0ZXIgdGV4dAogICAgY29uc3QgZmlsdGVyID0gY3JlYXRlRWxlbWVudChkYywgJ2lucHV0JywgWydmb3JtLWNvbnRyb2wnLCAnbXQtMicsICdtYi0yJ10pCiAgICBmaWx0ZXIucGxhY2Vob2xkZXIgPSAiRmlsdGVyIgogICAgCiAgICBjb25zdCBtYWluID0gY3JlYXRlRWxlbWVudChkYywgJ2RpdicsIFsnZC1mbGV4JywgJ292ZXJmbG93LWF1dG8nLCAnZmxleC13cmFwJ10pCiAgICBjcmVhdGVFbGVtZW50KGRjLCAnaHInLCBbJ3ctMTAwJ10pCiAgICBjb25zdCBhbGVydCA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbJ2FsZXJ0JywgJ2FsZXJ0LWRhbmdlcicsICdkLW5vbmUnXSkKICAgIGNvbnN0IGZvb3RlciA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbJ2QtZmxleCcsICdqdXN0aWZ5LWNvbnRlbnQtY2VudGVyJ10pCiAgICBjb25zdCBva0J0biA9IGNyZWF0ZUVsZW1lbnQoZm9vdGVyLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknLCAnbWUtMiddLCAnT0snKQoKICAgIGxldCBzZWxlY3RlZCA9IG9wdGlvbnMuaW5pdGlhbFNlbGVjdGlvbiB8fCBbXQoKICAgIGZ1bmN0aW9uIHN5bmNTZWxlY3RlZCgpIHsKICAgICAgICBzZWxlY3RlZENvbnRlbnQuaW5uZXJIVE1MID0gJycKICAgICAgICBjcmVhdGVFbGVtZW50KHNlbGVjdGVkQ29udGVudCwgJ3NwYW4nLCBbJ20tMSddLCAnU2VsZWN0ZWQ6ICcsIHtjb2xvcjogJ2JsdWUnfSkKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdGVkLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBzZWxlY3RlZFtpXQogICAgICAgICAgICBjb25zdCB0ZXh0ID0gb3B0aW9ucy5wcmVzZXJ2ZU9yZGVyID8gYCR7aSArIDF9OiAke2l0ZW19YCA6IGl0ZW0KICAgICAgICAgICAgY3JlYXRlRWxlbWVudChzZWxlY3RlZENvbnRlbnQsICdzcGFuJywgWydtLTEnXSwgdGV4dCkKICAgICAgICB9CgogICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBtYWluLmNoaWxkcmVuKSB7CiAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBpdGVtIGFzIEhUTUxTcGFuRWxlbWVudAogICAgICAgICAgICBjb25zdCBpc0l0ZW1TZWxlY3RlZCA9IHNlbGVjdGVkLmluY2x1ZGVzKGl0ZW0udGV4dENvbnRlbnQhKQogICAgICAgICAgICBzcGFuLmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgaXNJdGVtU2VsZWN0ZWQpCiAgICAgICAgICAgIHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gaXNJdGVtU2VsZWN0ZWQgPyAncmdiYSgwLCAxMjMsIDI1NSwgMC41KScgOiAncmdiKDI0NCwgMjQ0LCAyNDQpJwogICAgICAgIH0KICAgIH0KCiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZGF0YSkgewogICAgICAgIGNvbnN0IHNwYW4gPSBjcmVhdGVFbGVtZW50KG1haW4sICdzcGFuJywgWydtdWx0aS1zZWxlY3QnLCAncm91bmRlZC0xJywgJ3AtMScsICdtLTEnXSwgaXRlbSkKICAgICAgICBzcGFuLnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIgogICAgICAgIHNwYW4ub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgY29uc3Qgb2xkU2VsZWN0aW9uID0gWy4uLnNlbGVjdGVkXQogICAgICAgICAgICBjb25zdCBuZXdTZWxlY3Rpb24gPSBvcHRpb25zLnNpbmdsZVNlbGVjdCA/IFtpdGVtXSA6IChzZWxlY3RlZC5pbmNsdWRlcyhpdGVtKSA/IHNlbGVjdGVkLmZpbHRlcihpID0+IGkgIT09IGl0ZW0pIDogWy4uLnNlbGVjdGVkLCBpdGVtXSkKICAgICAgICAgICAgY29uc3QgciA9IG9wdGlvbnMuY2hlY2tlcj8uKG9sZFNlbGVjdGlvbiwgbmV3U2VsZWN0aW9uKQogICAgICAgICAgICBpZiAodHlwZW9mIHIgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAvLyBpbnZhbGlkIHN0YXRlCiAgICAgICAgICAgICAgICBhbGVydC50ZXh0Q29udGVudCA9IHIKICAgICAgICAgICAgICAgIGFsZXJ0LmNsYXNzTGlzdC5yZW1vdmUoJ2Qtbm9uZScpCiAgICAgICAgICAgICAgICBva0J0bi5kaXNhYmxlZCA9IHRydWUKICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gbmV3U2VsZWN0aW9uCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBmaXhlZCBzdGF0ZQogICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSByIHx8IG5ld1NlbGVjdGlvbgogICAgICAgICAgICAgICAgYWxlcnQuY2xhc3NMaXN0LmFkZCgnZC1ub25lJykKICAgICAgICAgICAgICAgIG9rQnRuLmRpc2FibGVkID0gZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgICBzeW5jU2VsZWN0ZWQoKQogICAgICAgIH0KICAgIH0KCiAgICBmaWx0ZXIub25pbnB1dCA9ICgpID0+IHsKICAgICAgICBjb25zdCB2ID0gZmlsdGVyLnZhbHVlLnRvTG93ZXJDYXNlKCkKICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbWFpbi5jaGlsZHJlbikgewogICAgICAgICAgICBpZiAoaXRlbS50ZXh0Q29udGVudD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2KSkgewogICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdkLW5vbmUnKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGxldCByZXNvbHZlcjogKCh2YWx1ZTogc3RyaW5nW118dW5kZWZpbmVkKSA9PiB2b2lkKQogICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlPHN0cmluZ1tdfHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIHJlc29sdmVyID0gcmVzb2x2ZQogICAgfSkKCiAgICBva0J0bi5vbmNsaWNrID0gKCkgPT4gewogICAgICAgIGRpYWxvZy5jbG9zZSgpCiAgICAgICAgZGlhbG9nLnJlbW92ZSgpCiAgICAgICAgcmVzb2x2ZXIoc2VsZWN0ZWQpCiAgICB9CgogICAgLy8gaGFuZGxlIGVzYyBrZXkgdG8gY2xvc2UgdGhlIGRpYWxvZwogICAgZGlhbG9nLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gewogICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsKICAgICAgICAgICAgZGlhbG9nLmNsb3NlKCkKICAgICAgICAgICAgZGlhbG9nLnJlbW92ZSgpCiAgICAgICAgICAgIHJlc29sdmVyKHVuZGVmaW5lZCkKICAgICAgICB9CiAgICB9KQoKICAgIHN5bmNTZWxlY3RlZCgpCiAgICBkaWFsb2cuc2hvd01vZGFsKCkKICAgIHJldHVybiBwcm9taXNlCn0KCmV4cG9ydCB0eXBlIFRhYmxlQ29sdW1uUHJvcGVydHkgPSB7CiAgICBmb3JtYXRlcj86ICh2YWx1ZTogYW55KSA9PiBzdHJpbmcgfCBIVE1MRWxlbWVudAogICAgc3R5bGU/OiBQYXJ0aWFsPENTU1N0eWxlRGVjbGFyYXRpb24+Cn0KZXhwb3J0IHR5cGUgVGFibGVQcmVzZW50YXRpb24gPSB7CiAgICBjb2x1bW5zOiBzdHJpbmdbXQogICAgY29sdW1uUHJvcGVydGllczogUmVjb3JkPHN0cmluZywgVGFibGVDb2x1bW5Qcm9wZXJ0eT4KICAgIHNvcnRCeTogewogICAgICAgIGNvbHVtbjogc3RyaW5nCiAgICAgICAgb3JkZXI6ICdhc2MnIHwgJ2Rlc2MnCiAgICB9W10KCiAgICAvLyBJZiBub3QgZW1wdHksIHJhdyBpbmRleCB3aWxsIGJlIHNob3duIGluIHRoZSBmaXJzdCBjb2x1bW4gd2l0aCB0aGUgZ2l2ZW4gbmFtZQogICAgLy8gbm90ZTogdGhpcyBjb2x1bW4gY2FuIGJlIGhpZGUgLyBzb3J0IGFzIHdlbGwKICAgIC8vIHR5cGljYWwgdXNhZ2VzIGlzIHBhc3NpbmcgYSAnIycgaGVyZQogICAgcmF3SW5kZXhDb2x1bW46IHN0cmluZwoKICAgIHBhZ2VTaXplPzogbnVtYmVyCiAgICBvblJvd0NsaWNrOiAoaXRlbTogYW55KSA9PiB2b2lkCiAgICBzdGF0ZUtleTogc3RyaW5nIC8vIHVzZWQgdG8gc2F2ZSB0aGUgc3RhdGUgb2YgdGhlIHRhYmxlIGluIGxvY2FsIHN0b3JhZ2UKfQoKZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhYmxlRnJvbUFycmF5KGFycjogYW55W10sIHByZXNlbnRhdGlvbjogUGFydGlhbDxUYWJsZVByZXNlbnRhdGlvbj4gPSB7fSkgewogICAgLy8gaGVscGVyIGZ1bmN0aW9ucwogICAgY29uc3QgdG9BcnJvdyA9IChzOiBzdHJpbmcpID0+IHMgPT09ICdhc2MnID8gJ+Kshu+4jycgOiAn4qyH77iPJwogICAgY29uc3QgZnJvbUFycm93ID0gKHM6IHN0cmluZykgPT4gcyA9PT0gJ+Kshu+4jycgPyAnYXNjJyA6ICdkZXNjJwogICAgY29uc3QgZGVmYXVsdENvbHVtbkZvcm1hdGVyID0gKHZhbHVlOiBhbnkpID0+IHsKICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gdHUuc2FmZUV4ZWN1dGUoKCkgPT4gSlNPTi5zdHJpbmdpZnkodmFsdWUsIG51bGwsIDIpLCBlID0+IGAke2V9YCkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gdmFsdWUgfHwgJycKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIG92ZXJhbGwgZG9tCiAgICBjb25zdCB2aWV3ID0gY3JlYXRlRWxlbWVudChudWxsLCAnZGl2JykKICAgIGNvbnN0IHRvb2xiYXIgPSBjcmVhdGVFbGVtZW50KHZpZXcsICdkaXYnLCBbJ2lucHV0LWdyb3VwJywgJ21iLTMnXSkKICAgIGNvbnN0IGZpZWxkU2VsZWN0ID0gY3JlYXRlRWxlbWVudCh0b29sYmFyLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknLCAnbWUtMiddLCAnQ29sdW1ucycpCiAgICBjb25zdCBzb3J0QnRuID0gY3JlYXRlRWxlbWVudCh0b29sYmFyLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknXSwgJ1NvcnQnKQogICAgY29uc3Qgc29ydEhpbnQgPSBjcmVhdGVFbGVtZW50KHRvb2xiYXIsICdzcGFuJywgWydpbnB1dC1ncm91cC10ZXh0JywgJ21lLTInXSwgJycpCiAgICBjcmVhdGVFbGVtZW50KHRvb2xiYXIsICdzcGFuJywgWydpbnB1dC1ncm91cC10ZXh0J10sICdGaWx0ZXInKQogICAgY29uc3QgZmlsdGVyID0gY3JlYXRlRWxlbWVudCh0b29sYmFyLCAnaW5wdXQnLCBbJ2Zvcm0tY29udHJvbCddLCAnJykKICAgIGNvbnN0IGNvdW50cyA9IGNyZWF0ZUVsZW1lbnQodG9vbGJhciwgJ3NwYW4nLCBbJ2lucHV0LWdyb3VwLXRleHQnXSwgJzIwIC8gMTAwJykKCiAgICAvLyBub3cgcGFnaW5nIHNlY3Rpb24sIHdoaWNoIGxvb2tzIGxpa2UgNCBidXR0b25zIGFuZCBhbiBlZGl0OiAiPDwgPCBbOF0gPiA+PgogICAgY29uc3QgcGFnaW5nID0gY3JlYXRlRWxlbWVudCh0b29sYmFyLCAnZGl2JywgWydidG4tZ3JvdXAnXSkKICAgIGNvbnN0IGZpcnN0QnRuID0gY3JlYXRlRWxlbWVudChwYWdpbmcsICdidXR0b24nLCBbJ2J0bicsICdidG4tcHJpbWFyeScsICdtcy0yJ10sICc8PCcpCiAgICBjb25zdCBwcmV2QnRuID0gY3JlYXRlRWxlbWVudChwYWdpbmcsICdidXR0b24nLCBbJ2J0bicsICdidG4tcHJpbWFyeSddLCAnPCcpCiAgICBjb25zdCBwYWdlVGV4dCA9IGNyZWF0ZUVsZW1lbnQocGFnaW5nLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXNlY29uZGFyeSddLCAnMjAgKiAyLzUnKQogICAgY29uc3QgbmV4dEJ0biA9IGNyZWF0ZUVsZW1lbnQocGFnaW5nLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknXSwgJz4nKQogICAgY29uc3QgbGFzdEJ0biA9IGNyZWF0ZUVsZW1lbnQocGFnaW5nLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknXSwgJz4+JykKCgogICAgY29uc3QgdGFibGUgPSBjcmVhdGVFbGVtZW50KHZpZXcsICd0YWJsZScsIFsndGFibGUnLCAndGFibGUtc3RyaXBlZCcsICd0YWJsZS1ib3JkZXJlZCcsICd0YWJsZS1ob3ZlciddKQogICAgY29uc3QgdGhlYWQgPSBjcmVhdGVFbGVtZW50KHRhYmxlLCAndGhlYWQnKQogICAgY29uc3QgdGJvZHkgPSBjcmVhdGVFbGVtZW50KHRhYmxlLCAndGJvZHknKQoKICAgIC8vIGxvY2FsIHN0YXRlcwogICAgY29uc3QgcHJvcGVydGllcyA9IFtwcmVzZW50YXRpb24ucmF3SW5kZXhDb2x1bW4sIC4uLnR1LmRhdGFQcm9wZXJ0aWVzKGFycildLmZpbHRlcihCb29sZWFuKSBhcyBzdHJpbmdbXQogICAgbGV0IGN1cnJlbnRQYWdlID0gMCAvLyBwYWdlIHdvbid0IGJlIHBlcnNpc3RlZAogICAgbGV0IHRvdGFsVmlzaWJsZSA9IDAgLy8gdG90YWwgdmlzaWJsZSByb3dzLCB1c2VkIGZvciBwYWdpbmcKICAgIGNvbnN0IHN0YXRlID0gdHUuY3JlYXRlU3RhdGUocHJlc2VudGF0aW9uLCBbJ2NvbHVtbnMnLCAnc29ydEJ5J10sIHByZXNlbnRhdGlvbi5zdGF0ZUtleSkKCiAgICB0eXBlIFJvdyA9IEhUTUxUYWJsZVJvd0VsZW1lbnQgJiB7IHJhd0luZGV4OiBudW1iZXIgfQogICAgCiAgICBmdW5jdGlvbiBjb25zdHJ1Y3RUYWJsZSgpIHsKICAgICAgICBjb25zdCB0ciA9IGNyZWF0ZUVsZW1lbnQodGhlYWQsICd0cicsIFtdKQogICAgICAgIGZvciAoY29uc3QgcHJvcCBvZiBwcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgIGNvbnN0IHRoID0gY3JlYXRlRWxlbWVudCh0ciwgJ3RoJywgW10sIHByb3AsIHtjdXJzb3I6ICdwb2ludGVyJywgdXNlclNlbGVjdDogJ25vbmUnfSkKICAgICAgICAgICAgdGgub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBzdGF0ZS5zb3J0Qnk/LmZpbmQocyA9PiBzLmNvbHVtbiA9PT0gcHJvcCkKICAgICAgICAgICAgICAgIGlmIChzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHMub3JkZXIgPT09ICdhc2MnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnNvcnRCeSA9IFt7Y29sdW1uOiBwcm9wLCBvcmRlcjogJ2Rlc2MnfV0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHMub3JkZXIgPT09ICdkZXNjJykgewogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5zb3J0QnkgPSBbXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3RhdGUuc29ydEJ5ID0gW3tjb2x1bW46IHByb3AsIG9yZGVyOiAnYXNjJ31dCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBhcHBseVNvcnQoKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgCiAgICAgICAgLy8gY3JlYXRlIHRoZSB0YWJsZSBib2R5CiAgICAgICAgZm9yIChjb25zdCBbaSwgaXRlbV0gb2YgYXJyLmVudHJpZXMoKSkgewogICAgICAgICAgICBjb25zdCB0ciA9IGNyZWF0ZUVsZW1lbnQodGJvZHksICd0cicsIFtdKTsKICAgICAgICAgICAgKHRyIGFzIFJvdykucmF3SW5kZXggPSBpCiAgICAgICAgICAgIGZvciAoY29uc3QgcHJvcCBvZiBwcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgICAgICBjb25zdCB0ZCA9IGNyZWF0ZUVsZW1lbnQodHIsICd0ZCcsIFtdLCAnJywgcHJlc2VudGF0aW9uLmNvbHVtblByb3BlcnRpZXM/Lltwcm9wXT8uc3R5bGUpCiAgICAgICAgICAgICAgICBjb25zdCB2ID0gaXRlbVtwcm9wXQogICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0ZXIgPSBwcmVzZW50YXRpb24uY29sdW1uUHJvcGVydGllcz8uW3Byb3BdPy5mb3JtYXRlciB8fCBkZWZhdWx0Q29sdW1uRm9ybWF0ZXIKICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gKHByb3AgPT09IHByZXNlbnRhdGlvbi5yYXdJbmRleENvbHVtbik/IGAke2l9YCA6IGZvcm1hdGVyKHYpCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZvcm1hdHRlZFZhbHVlID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgICAgIHRkLnRleHRDb250ZW50ID0gZm9ybWF0dGVkVmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZvcm1hdHRlZFZhbHVlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICB0ZC5hcHBlbmRDaGlsZChmb3JtYXR0ZWRWYWx1ZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgCiAgICAgICAgICAgIGlmIChwcmVzZW50YXRpb24ub25Sb3dDbGljaykgewogICAgICAgICAgICAgICAgdHIub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBwcmVzZW50YXRpb24ub25Sb3dDbGljayEoaXRlbSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRyLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdvdG9QYWdlKHBhZ2U6IG51bWJlcikgewogICAgICAgIGNvbnN0IHBhZ2VTaXplID0gcHJlc2VudGF0aW9uLnBhZ2VTaXplIHx8IEluZmluaXR5CiAgICAgICAgY29uc3QgbGFzdFBhZ2UgPSBNYXRoLmZsb29yKHRvdGFsVmlzaWJsZSAvIHBhZ2VTaXplKQogICAgICAgIGlmIChwYWdlIDwgMCkgcGFnZSA9IDAKICAgICAgICBpZiAocGFnZSA+IGxhc3RQYWdlKSBwYWdlID0gbGFzdFBhZ2UKICAgICAgICBjdXJyZW50UGFnZSA9IHBhZ2UKICAgICAgICBhcHBseVBhZ2luZygpCiAgICB9CgogICAgZnVuY3Rpb24gYXBwbHlQYWdpbmcoKSB7CiAgICAgICAgY29uc3QgcGFnZVNpemUgPSBwcmVzZW50YXRpb24ucGFnZVNpemUgfHwgSW5maW5pdHkKICAgICAgICAvLyBvbmx5IHZpc2libGUgcm93cyBmYWxsaW5nIGludG8gdGhlIGN1cnJlbnQgcGFnZSBhcmUgc2hvd24sIGFsbCBvdGhlcnMgYXJlIGhpZGRlbgogICAgICAgIGxldCBwb3MgPSAwCiAgICAgICAgZm9yIChjb25zdCByb3cgb2YgdGJvZHkuY2hpbGRyZW4pIHsKICAgICAgICAgICAgY29uc3QgciA9IHJvdyBhcyBSb3cKCiAgICAgICAgICAgIGlmIChyLmNsYXNzTGlzdC5jb250YWlucygnaW52aXNpYmxlJykpIHsKICAgICAgICAgICAgICAgIHIuY2xhc3NMaXN0LnRvZ2dsZSgnZC1ub25lJywgdHJ1ZSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IHBhZ2UgPSBNYXRoLmZsb29yKHBvcyAvIHBhZ2VTaXplKQogICAgICAgICAgICBpZiAocGFnZSA9PT0gY3VycmVudFBhZ2UpIHsKICAgICAgICAgICAgICAgIHIuY2xhc3NMaXN0LnRvZ2dsZSgnZC1ub25lJywgZmFsc2UpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByLmNsYXNzTGlzdC50b2dnbGUoJ2Qtbm9uZScsIHRydWUpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcG9zKysKICAgICAgICB9CiAgICAgICAgcGFnZVRleHQudGV4dENvbnRlbnQgPSBgJHtjdXJyZW50UGFnZSArIDF9IC8gJHtNYXRoLmNlaWwodG90YWxWaXNpYmxlIC8gcHJlc2VudGF0aW9uLnBhZ2VTaXplISl9YAogICAgICAgIGlmICghcHJlc2VudGF0aW9uLnBhZ2VTaXplKSB7CiAgICAgICAgICAgIHBhZ2luZy5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBhcHBseUZpbHRlcihzOiBzdHJpbmcpIHsKICAgICAgICB0b3RhbFZpc2libGUgPSAwCiAgICAgICAgbGV0IHRvdGFsID0gMAogICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0Ym9keS5jaGlsZHJlbikgewogICAgICAgICAgICBsZXQgbWVldCA9IGZhbHNlCiAgICAgICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiBpdGVtLmNoaWxkcmVuKSB7CiAgICAgICAgICAgICAgICBpZiAoY2VsbC50ZXh0Q29udGVudD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzKSkgewogICAgICAgICAgICAgICAgICAgIG1lZXQgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0b3RhbCsrCiAgICAgICAgICAgIHRvdGFsVmlzaWJsZSArPSAobWVldCA/IDEgOiAwKQogICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ2ludmlzaWJsZScsICFtZWV0KQogICAgICAgIH0KICAgICAgICBjb3VudHMudGV4dENvbnRlbnQgPSBgJHt0b3RhbFZpc2libGV9IC8gJHt0b3RhbH1gCiAgICAgICAgY3VycmVudFBhZ2UgPSAwCiAgICB9CgogICAgZnVuY3Rpb24gc2hvd2hpZGVDb2x1bW5zKCkgewogICAgICAgIGZvckVhY2hUYWJsZUNlbGwodGFibGUsIChjZWxsLCByb3csIGNvbCkgPT4gewogICAgICAgICAgICBjZWxsLnN0eWxlLmRpc3BsYXkgPSAoc3RhdGUuY29sdW1ucz8/cHJvcGVydGllcykuaW5jbHVkZXMocHJvcGVydGllc1tjb2xdKSA/ICcnIDogJ25vbmUnCiAgICAgICAgfSkKICAgIH0KCiAgICBmdW5jdGlvbiBhcHBseVNvcnQoKSB7CiAgICAgICAgLy8gdXBkYXRlIHNvcnQgaGludAogICAgICAgIGNvbnN0IHNvcnRCeSA9IHN0YXRlLnNvcnRCeSB8fCBbXQogICAgICAgIHNvcnRIaW50LnRleHRDb250ZW50ID0gYCR7c29ydEJ5Lm1hcChzID0+IGAke3MuY29sdW1ufSAke3RvQXJyb3cocy5vcmRlcil9YCkuam9pbignLCAnKX1gCiAgICAgICAgCiAgICAgICAgLy8gdXBkYXRlIHRhYmxlIGhlYWRlciB0byBzaG93IHNvcnQgJiBvcmRlcgogICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBwcm9wXSBvZiBwcm9wZXJ0aWVzLmVudHJpZXMoKSkgewogICAgICAgICAgICBjb25zdCB0aCA9IHRoZWFkLmNoaWxkcmVuWzBdLmNoaWxkcmVuW2luZGV4XSBhcyBIVE1MVGFibGVDZWxsRWxlbWVudAogICAgICAgICAgICB0aC5pbm5lckhUTUwgPSAnJyAvLyBjbGVhciB0aGUgaGVhZGVyIGNvbnRlbnQKICAgICAgICAgICAgY3JlYXRlRWxlbWVudCh0aCwgJ3NwYW4nLCBbXSwgcHJvcCkKICAgICAgICAgICAgY29uc3QgaSA9IHNvcnRCeS5maW5kSW5kZXgocyA9PiBzLmNvbHVtbiA9PT0gcHJvcCkKICAgICAgICAgICAgaWYgKGkgPj0gMCkgewogICAgICAgICAgICAgICAgY29uc3QgcyA9IHNvcnRCeVtpXQogICAgICAgICAgICAgICAgY3JlYXRlRWxlbWVudCh0aCwgJ3NwYW4nLCBbXSwgdG9BcnJvdyhzLm9yZGVyKSkKICAgICAgICAgICAgICAgIGlmIChzb3J0QnkubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgICAgIGNyZWF0ZUVsZW1lbnQodGgsICdzcGFuJywgW10sIGAke2kgKyAxfWAsIHt2ZXJ0aWNhbEFsaWduOiAnc3VwZXInLCBmb250U2l6ZTogJzAuOGVtJ30pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIHNvcnQgdGhlIHRhYmxlIHJvd3MKICAgICAgICBjb25zdCByb3dzID0gQXJyYXkuZnJvbSh0Ym9keS5jaGlsZHJlbikgYXMgUm93W10KICAgICAgICBpZiAoc29ydEJ5Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcm93cy5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHMgb2Ygc29ydEJ5KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgYVZhbHVlID0gKHMuY29sdW1uID09PSBwcmVzZW50YXRpb24ucmF3SW5kZXhDb2x1bW4pPyBhLnJhd0luZGV4IDogYXJyW2EucmF3SW5kZXhdW3MuY29sdW1uXQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGJWYWx1ZSA9IChzLmNvbHVtbiA9PT0gcHJlc2VudGF0aW9uLnJhd0luZGV4Q29sdW1uKT8gYi5yYXdJbmRleCA6IGFycltiLnJhd0luZGV4XVtzLmNvbHVtbl0KICAgICAgICAgICAgICAgICAgICBpZiAoYVZhbHVlIDwgYlZhbHVlKSByZXR1cm4gcy5vcmRlciA9PT0gJ2FzYycgPyAtMSA6IDEKICAgICAgICAgICAgICAgICAgICBpZiAoYVZhbHVlID4gYlZhbHVlKSByZXR1cm4gcy5vcmRlciA9PT0gJ2FzYycgPyAxIDogLTEKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIH0pCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcm93cy5zb3J0KChhLCBiKSA9PiBhLnJhd0luZGV4IC0gYi5yYXdJbmRleCkKICAgICAgICB9CgogICAgICAgIHRib2R5LmlubmVySFRNTCA9ICcnCiAgICAgICAgdGJvZHkuYXBwZW5kKC4uLnJvd3MpCiAgICAgICAgYXBwbHlQYWdpbmcoKQogICAgfQoKICAgIGZpZWxkU2VsZWN0Lm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgY29uc3QgciA9IGF3YWl0IHNob3dTZWxlY3Rpb24oJ1NlbGVjdCBGaWVsZHMnLCBwcm9wZXJ0aWVzLCB7aW5pdGlhbFNlbGVjdGlvbjogc3RhdGUuY29sdW1ucz8/cHJvcGVydGllc30pCiAgICAgICAgaWYgKHIgPT09IHVuZGVmaW5lZCkgcmV0dXJuCgogICAgICAgIC8vIE5vdGU6IHNlbGVjdCBhbGwgbWVhbnMgbm90IGp1c3Qgc2VsZWN0IGFsbCB0aGlzIHRpbWUsIGJ1dCBmb3IgZnV0dXJlIGFzIHdlbGwKICAgICAgICAvLyAgICAgICBzbyB3ZSBjYW5ub3QganVzdCBzYXZlIHRoZSBjdXJyZW50IGZ1bGwgc2V0IG9mIHByb3BlcnRpZXMKICAgICAgICAvLyAgICAgICB3ZSBuZWVkIHRvIHNhdmUgYHVuZGVmaW5lZGAgdG8gZXhwcmVzcyB0aGlzIHNlbWFudGljcwogICAgICAgIC8vIFRPRE86IGZpbmQgYSBtb3JlIGRlc2NyaXB0aXZlIHdheQogICAgICAgIHN0YXRlLmNvbHVtbnMgPSAoci5sZW5ndGggPT09IHByb3BlcnRpZXMubGVuZ3RoKT8gdW5kZWZpbmVkIDogcgogICAgICAgIHNob3doaWRlQ29sdW1ucygpCiAgICB9CgogICAgc29ydEJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4gewogICAgICAgIC8vIGNvbnN0cnVjdCBhbGwgcHJvcGVydGllcwogICAgICAgIGNvbnN0IGFsbE9wdGlvbnMgPSBwcm9wZXJ0aWVzLm1hcChwID0+IFtgJHtwfSAke3RvQXJyb3coJ2FzYycpfWAsIGAke3B9ICR7dG9BcnJvdygnZGVzYycpfWBdKS5mbGF0KCkKICAgICAgICBjb25zdCBzb3J0T3B0aW9ucyA9IHN0YXRlLnNvcnRCeT8ubWFwKHMgPT4gYCR7cy5jb2x1bW59ICR7dG9BcnJvdyhzLm9yZGVyKX1gKQogICAgICAgIGNvbnN0IGNoZWNrZXIgPSAob2xkU2VsZWN0aW9uOiBzdHJpbmdbXSwgbmV3U2VsZWN0aW9uOiBzdHJpbmdbXSkgPT4gewogICAgICAgICAgICBpZiAobmV3U2VsZWN0aW9uLmxlbmd0aCA+IG9sZFNlbGVjdGlvbi5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIC8vIGEgbmV3IHNvcnQgaXMgYWRkZWQsIHdlIHdpbGwgbWFrZSBzdXJlIHRvIHJlbW92ZSBvbGQgZHVwbGljYXRlcyBpZiB0aGVyZSBpcwogICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IG5ld1NlbGVjdGlvbltuZXdTZWxlY3Rpb24ubGVuZ3RoIC0gMV0KICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IGl0ZW0uc3BsaXQoJyAnKVswXQogICAgICAgICAgICAgICAgcmV0dXJuIG9sZFNlbGVjdGlvbi5maWx0ZXIocyA9PiBzLnNwbGl0KCcgJylbMF0gIT09IGtleSkuY29uY2F0KFtpdGVtXSkKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbmV3U2VsZWN0aW9uCiAgICAgICB9CiAgICAgICAgY29uc3QgciA9IGF3YWl0IHNob3dTZWxlY3Rpb24oJ1NvcnQgQnknLCBhbGxPcHRpb25zLCB7cHJlc2VydmVPcmRlcjogdHJ1ZSwgaW5pdGlhbFNlbGVjdGlvbjogc29ydE9wdGlvbnMsIGNoZWNrZXJ9KQogICAgICAgIGlmIChyID09PSB1bmRlZmluZWQpIHJldHVybgogICAgICAgIHN0YXRlLnNvcnRCeSA9IHIubWFwKHMgPT4gewogICAgICAgICAgICBjb25zdCBbY29sdW1uLCBvcmRlcl0gPSBzLnNwbGl0KCcgJykKICAgICAgICAgICAgcmV0dXJuIHtjb2x1bW4sIG9yZGVyOiBmcm9tQXJyb3cob3JkZXIpIGFzICdhc2MnIHwgJ2Rlc2MnfQogICAgICAgIH0pCiAgICAgICAgYXBwbHlTb3J0KCkKICAgIH0KCiAgICBmaWx0ZXIub25pbnB1dCA9ICgpID0+IHsKICAgICAgICBjb25zdCB2ID0gZmlsdGVyLnZhbHVlLnRvTG93ZXJDYXNlKCkKICAgICAgICBhcHBseUZpbHRlcih2KQogICAgICAgIGFwcGx5UGFnaW5nKCkKICAgIH0KCiAgICBwYWdlVGV4dC5vbmNsaWNrID0gKCkgPT4gewogICAgICAgIGNvbnN0IHBhZ2UgPSBOdW1iZXIocHJvbXB0KCdQYWdlIHNpemUnLCBgJHtwcmVzZW50YXRpb24ucGFnZVNpemUgfHwgMjB9YCkpCiAgICAgICAgZ290b1BhZ2UocGFnZSAtIDEpCiAgICB9CiAgICBmaXJzdEJ0bi5vbmNsaWNrID0gKCkgPT4gZ290b1BhZ2UoMCkKICAgIHByZXZCdG4ub25jbGljayA9ICgpID0+IGdvdG9QYWdlKGN1cnJlbnRQYWdlIC0gMSkKICAgIG5leHRCdG4ub25jbGljayA9ICgpID0+IGdvdG9QYWdlKGN1cnJlbnRQYWdlICsgMSkKICAgIGxhc3RCdG4ub25jbGljayA9ICgpID0+IGdvdG9QYWdlKEluZmluaXR5KQoKICAgIC8vIGxvZ2ljIHN0YXJ0IGhlcmUKICAgIGNvbnN0cnVjdFRhYmxlKCkKICAgIHNob3doaWRlQ29sdW1ucygpCiAgICBhcHBseUZpbHRlcignJykKICAgIGFwcGx5U29ydCgpCiAgICByZXR1cm4gdmlldwp9Cgo="
}
