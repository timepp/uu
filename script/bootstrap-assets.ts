export const assets: Record<string, string> = {
  "uu.ts": "Ly8gdXU6IGEgc2V0IG9mIHV0aWxpdHkgZnVuY3Rpb25zIGZvciBtb2Rlcm4gd2ViIFVJDQovLyBoYXNoOiBmZmViYzQyNGVmZTkxMzZlYThiYzhjMTQ3OGVkNTFmYjFjODY2NzdmM2IzNzI5NGI3NzY3OGQ1NDE5ZmFlYzQyDQovLyBQbGVhc2UgZG8gbm90IG1vZGlmeSB0aGlzIGZpbGUgZGlyZWN0bHkuIFVzZSB0aGUgZm9sbG93aW5nIGNvbW1hbmQgdG8gdXBkYXRlIHRoaXMgZmlsZSBvbiBhIGRlbm8gZW52aXJvbm1lbnQ6DQovLyBkZW5vIHJ1biAtQSAtLXJlbG9hZCBqc3I6QHRpbWVwcC91dS9pbnN0YWxsDQoNCmltcG9ydCAqIGFzIHR1IGZyb20gJy4vdHUudHMnDQpleHBvcnQgKiBmcm9tICcuL3R1LnRzJw0KDQpleHBvcnQgZnVuY3Rpb24gdHJpZ2dlckRvd25sb2FkKGJsb2I6IEJsb2IsIGZpbGVuYW1lOiBzdHJpbmcpIHsNCiAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpDQogICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKQ0KICAgIGEuaHJlZiA9IHVybA0KICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZQ0KICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSkNCiAgICBhLmNsaWNrKCkNCiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGEpDQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBkZXJpdmVkVXJsKG9sZFVybDogc3RyaW5nLCBwYXJhbXNUb0FkZDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgcGFyYW1zVG9SZW1vdmU/OiBSZWdFeHApIHsNCiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKG9sZFVybCkNCiAgICBpZiAocGFyYW1zVG9SZW1vdmUpIHsNCiAgICAgICAgY29uc3Qga2V5cyA9IFsuLi51cmwuc2VhcmNoUGFyYW1zLmtleXMoKV0NCiAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICAgICAgaWYgKHBhcmFtc1RvUmVtb3ZlLnRlc3Qoa2V5KSkgew0KICAgICAgICAgICAgICAgIHVybC5zZWFyY2hQYXJhbXMuZGVsZXRlKGtleSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhwYXJhbXNUb0FkZCkpIHsNCiAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoa2V5LCB2YWx1ZSkNCiAgICB9DQogICAgcmV0dXJuIHVybC50b1N0cmluZygpDQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBkZXJpdmVkQ3VycmVudFVybChwYXJhbXNUb0FkZDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgcGFyYW1zVG9SZW1vdmU/OiBSZWdFeHApIHsNCiAgICByZXR1cm4gZGVyaXZlZFVybCh3aW5kb3cubG9jYXRpb24uaHJlZiwgcGFyYW1zVG9BZGQsIHBhcmFtc1RvUmVtb3ZlKQ0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gY3JlYXRlRWxlbWVudDxLIGV4dGVuZHMga2V5b2YgSFRNTEVsZW1lbnRUYWdOYW1lTWFwPihwYXJlbnQ6IEVsZW1lbnQgfCBudWxsLCB0YWdOYW1lOiBLLCBjbGFzc2VzOiBzdHJpbmdbXSA9IFtdLCB0ZXh0Pzogc3RyaW5nLCBzdHlsZTogUGFydGlhbDxDU1NTdHlsZURlY2xhcmF0aW9uPiA9IHt9KSB7DQogICAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSkNCiAgICBlLmNsYXNzTGlzdC5hZGQoLi4uY2xhc3NlcykNCiAgICBpZiAocGFyZW50KSBwYXJlbnQuYXBwZW5kQ2hpbGQoZSkNCiAgICBpZiAodGV4dCkgZS50ZXh0Q29udGVudCA9IHRleHQNCiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhzdHlsZSkpIHsNCiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIGUuc3R5bGVba2V5IGFzIGFueV0gPSB2YWx1ZSBhcyBzdHJpbmcNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gZQ0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gZm9yRWFjaFRhYmxlQ2VsbCh0YWJsZTogSFRNTFRhYmxlRWxlbWVudCwgY2FsbGJhY2s6IChjZWxsOiBIVE1MVGFibGVDZWxsRWxlbWVudCwgcm93OiBudW1iZXIsIGNvbDogbnVtYmVyKSA9PiB2b2lkKSB7DQogICAgLy8gcm93OiAwIGlzIGhlYWRlciwgMSBpcyBmaXJzdCByb3cNCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhYmxlLnJvd3MubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgY29uc3Qgcm93ID0gdGFibGUucm93c1tpXQ0KICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHJvdy5jZWxscy5sZW5ndGg7IGorKykgew0KICAgICAgICAgICAgY29uc3QgY2VsbCA9IHJvdy5jZWxsc1tqXQ0KICAgICAgICAgICAgY2FsbGJhY2soY2VsbCwgaSwgaikNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbGxBc3luY0Z1bmN0aW9uV2l0aFByb2dyZXNzPFQ+KGZuOiAoKSA9PiBQcm9taXNlPFQ+KSB7DQogICAgY29uc3QgZGlhbG9nID0gY3JlYXRlRWxlbWVudChkb2N1bWVudC5ib2R5LCAnZGlhbG9nJywgW10pDQogICAgY29uc3QgZGMgPSBjcmVhdGVFbGVtZW50KGRpYWxvZywgJ2RpdicsIFtdKQ0KICAgIGRjLnN0eWxlLnRleHRBbGlnbiA9ICJjZW50ZXIiDQogICAgY3JlYXRlRWxlbWVudChkYywgJ2g0JywgWydtLTInXSwgJ1BsZWFzZSB3YWl0Li4uJykNCiAgICAvLyBzaG93IGEgY2VudGVyZWQgc3Bpbm5lcg0KICAgIGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbJ3NwaW5uZXItYm9yZGVyJywgJ3RleHQtcHJpbWFyeSddLCAnJykNCiAgICBkaWFsb2cuc2hvd01vZGFsKCkNCiAgICB0cnkgew0KICAgICAgICBjb25zdCByID0gYXdhaXQgZm4oKQ0KICAgICAgICBkaWFsb2cuY2xvc2UoKQ0KICAgICAgICBkaWFsb2cucmVtb3ZlKCkNCiAgICAgICAgcmV0dXJuIHINCiAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIGRpYWxvZy5jbG9zZSgpDQogICAgICAgIGRpYWxvZy5yZW1vdmUoKQ0KICAgICAgICB0aHJvdyBlDQogICAgfQ0KfQ0KDQovLyBzaG93IGluZm9ybWF0aW9uIGRpYWxvZywgY29udGVudCBpcyBub3JtYWwgdGV4dCwgZGlhbG9nIG5vIGxvbmdlciBmaXggaGVpZ2h0DQpleHBvcnQgZnVuY3Rpb24gc2hvd0luZm8odGl0bGU6IHN0cmluZywgY29udGVudDogc3RyaW5nKSB7DQogICAgY29uc3QgZGlhbG9nID0gY3JlYXRlRWxlbWVudChkb2N1bWVudC5ib2R5LCAnZGlhbG9nJywgW10pDQoNCiAgICBjb25zdCBkYyA9IGNyZWF0ZUVsZW1lbnQoZGlhbG9nLCAnZGl2JywgW10pDQoNCiAgICBjb25zdCBoZWFkZXIgPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pDQogICAgaGVhZGVyLnN0eWxlLnRleHRBbGlnbiA9ICJjZW50ZXIiDQogICAgY3JlYXRlRWxlbWVudChoZWFkZXIsICdoMicsIFtdLCB0aXRsZSkNCiAgICBjcmVhdGVFbGVtZW50KGRjLCAnaHInLCBbXSkNCg0KICAgIGNvbnN0IG1haW4gPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pDQogICAgbWFpbi5zdHlsZS5tYXhXaWR0aCA9ICI4MDBweCINCiAgICBjb25zdCBoID0gdHUuc2VnbWVudEJ5UmVnZXgoY29udGVudCwgW1svZXJyb3I6L2lnLCAncmVkJ11dKQ0KICAgIC8vIG1haW4uYXBwZW5kQ2hpbGQoaCkNCg0KICAgIGNyZWF0ZUVsZW1lbnQoZGMsICdocicsIFtdKQ0KDQogICAgY29uc3QgZm9vdGVyID0gY3JlYXRlRWxlbWVudChkYywgJ2RpdicsIFsnZC1mbGV4JywgJ2p1c3RpZnktY29udGVudC1jZW50ZXInXSkNCiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoZm9vdGVyLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknXSwgJ0Nsb3NlJykNCiAgICBjbG9zZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gew0KICAgICAgICBkaWFsb2cuY2xvc2UoKQ0KICAgICAgICBkaWFsb2cucmVtb3ZlKCkNCiAgICB9DQogICAgZGlhbG9nLnNob3dNb2RhbCgpDQogICAgcmV0dXJuIGRpYWxvZw0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gaGlnaGxpZ2h0VGV4dCh0ZXh0OiBzdHJpbmcsIHJ1bGVzOiBbUmVnRXhwLCBzdHJpbmddW10pIHsNCiAgICBjb25zdCBwYXJ0cyA9IHR1LnNlZ21lbnRCeVJlZ2V4KHRleHQsIHJ1bGVzKQ0KICAgIHJldHVybiBwYXJ0cy5tYXAocGFydCA9PiB7DQogICAgICAgIGNvbnN0IHNwYW4gPSBjcmVhdGVFbGVtZW50KG51bGwsICdzcGFuJywgW10sIHBhcnQuY29udGVudCkNCiAgICAgICAgaWYgKHBhcnQuY2F0ZWdvcnkpIHsNCiAgICAgICAgICAgIHNwYW4uc3R5bGUuY29sb3IgPSBwYXJ0LmNhdGVnb3J5DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHNwYW4NCiAgICB9KQ0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gY3JlYXRlSnNvblZpZXcoY29udGVudDogc3RyaW5nKSB7DQogICAgY29uc3QgcGFydHMgPSB0dS5zZWdtZW50SnNvbihjb250ZW50KQ0KICAgIGNvbnN0IHByZSA9IGNyZWF0ZUVsZW1lbnQobnVsbCwgJ3ByZScsIFtdKQ0KDQogICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRzKSB7DQogICAgICAgIGNvbnN0IHNwYW4gPSBjcmVhdGVFbGVtZW50KHByZSwgJ3NwYW4nKQ0KICAgICAgICBzcGFuLnRleHRDb250ZW50ID0gcGFydC5jb250ZW50DQogICAgICAgIHN3aXRjaCAocGFydC5jYXRlZ29yeSkgew0KICAgICAgICAgICAgY2FzZSAna2V5Jzogc3Bhbi5zdHlsZS5jb2xvciA9ICdibHVlJzsgYnJlYWsNCiAgICAgICAgICAgIC8vIGNhc2UgJ3N0cmluZyc6IHNwYW4uc3R5bGUuY29sb3IgPSAncHVycGxlJzsgYnJlYWsNCiAgICAgICAgICAgIGNhc2UgJ251bWJlcic6IHNwYW4uc3R5bGUuY29sb3IgPSAnI2Y0MzllNic7IGJyZWFrDQogICAgICAgICAgICBjYXNlICd0cnVlJzogc3Bhbi5zdHlsZS5jb2xvciA9ICdncmVlbic7IGJyZWFrDQogICAgICAgICAgICBjYXNlICdmYWxzZSc6IHNwYW4uc3R5bGUuY29sb3IgPSAncmVkJzsgYnJlYWsNCiAgICAgICAgICAgIGNhc2UgJ251bGwnOiBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd5ZWxsb3cnOyBicmVhaw0KICAgICAgICAgICAgY2FzZSAncHVuY3R1YXRpb24nOiBzcGFuLnN0eWxlLmZvbnRXZWlnaHQgPSAiODAwIjsgYnJlYWsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBwcmUNCn0NCg0KZXhwb3J0IGZ1bmN0aW9uIHNob3dMYXJnZUpzb25SZXN1bHQodGl0bGU6IHN0cmluZywgY29udGVudDogc3RyaW5nKSB7DQogICAgY29uc3QgZGlhbG9nID0gY3JlYXRlRWxlbWVudChkb2N1bWVudC5ib2R5LCAnZGlhbG9nJywgW10pDQogICAgZGlhbG9nLnN0eWxlLndpZHRoID0gIjgwdnciOyAgDQogICAgZGlhbG9nLnN0eWxlLmhlaWdodCA9ICI4MHZoIjsgDQoNCiAgICBjb25zdCBkYyA9IGNyZWF0ZUVsZW1lbnQoZGlhbG9nLCAnZGl2JywgW10pDQogICAgZGMuc3R5bGUud2lkdGggPSAiMTAwJSI7ICAgLy8g5a695bqmMTAwJQ0KICAgIGRjLnN0eWxlLmhlaWdodCA9ICIxMDAlIjsgIC8vIOmrmOW6pjEwMCUNCiAgICBkYy5zdHlsZS5kaXNwbGF5ID0gImZsZXgiOw0KICAgIGRjLnN0eWxlLmFsaWduSXRlbXMgPSAiY2VudGVyIjsNCiAgICBkYy5zdHlsZS5mbGV4RGlyZWN0aW9uID0gImNvbHVtbiI7DQoNCiAgICBjb25zdCBoZWFkZXIgPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pDQogICAgY3JlYXRlRWxlbWVudChoZWFkZXIsICdoMicsIFtdLCB0aXRsZSkNCg0KICAgIGNvbnN0IG1haW4gPSBjcmVhdGVFbGVtZW50KGRjLCAncHJlJywgW10pDQogICAgY29uc3Qgc3BhbnMgPSBoaWdobGlnaHRUZXh0KGNvbnRlbnQsIFtbLyJbXiJdKyI6L2csICdibHVlJ10sIFsv4oCmWzAtOV0rIG1vcmUgKGNoYXJzfGl0ZW1zKeKApi9nLCAncmVkJ11dKQ0KICAgIG1haW4uYXBwZW5kKC4uLnNwYW5zKQ0KICAgIG1haW4uc3R5bGUuZmxleEdyb3cgPSAiMSI7ICAgLy8g6K6pIHRleHRhcmVhIOWNoOa7oeWJqeS9meepuumXtA0KICAgIG1haW4uc3R5bGUud2lkdGggPSAiMTAwJSI7ICAgLy8g5a695bqmMTAwJQ0KDQogICAgY29uc3QgY2xvc2VCdXR0b24gPSBjcmVhdGVFbGVtZW50KGRjLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknXSwgJ0Nsb3NlJykNCiAgICBjbG9zZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gew0KICAgICAgICBkaWFsb2cuY2xvc2UoKQ0KICAgICAgICBkaWFsb2cucmVtb3ZlKCkNCiAgICB9DQogICAgZGlhbG9nLnNob3dNb2RhbCgpDQogICAgcmV0dXJuIGRpYWxvZw0KfQ0KDQpleHBvcnQgdHlwZSBTZWxlY3RPcHRpb24gPSB7DQogICAgc2luZ2xlU2VsZWN0OiBib29sZWFuDQogICAgcHJlc2VydmVPcmRlcjogYm9vbGVhbg0KICAgIGluaXRpYWxTZWxlY3Rpb246IHN0cmluZ1tdDQoNCiAgICAvLyByZXR1cm4gYG5ld1NlbGVjdGlvbmAgaWYgdGhlIG5ldyBzZWxlY3Rpb24gaXMgdmFsaWQNCiAgICAvLyBvdGhlcndpc2UsIHJldHVybiBhIHNlbGVjdGlvbiBpZiBjaGVja2VyIGNhbiBmaXggaW52YWxpZCBzZWxlY3Rpb24NCiAgICAvLyBvdGhlcndpc2UsIHJldHVybiBhbiBlcnJvciBtZXNzYWdlDQogICAgY2hlY2tlcjogKG9sZFNlbGVjdGlvbjogc3RyaW5nW10sIG5ld1NlbGVjdGlvbjogc3RyaW5nW10pID0+IHN0cmluZ1tdIHwgc3RyaW5nDQp9DQoNCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaG93U2VsZWN0aW9uKHRpdGxlOiBzdHJpbmcsIGRhdGE6IHN0cmluZ1tdLCBvcHRpb25zOiBQYXJ0aWFsPFNlbGVjdE9wdGlvbj4pIHsNCiAgICBjb25zdCBkaWFsb2cgPSBjcmVhdGVFbGVtZW50KGRvY3VtZW50LmJvZHksICdkaWFsb2cnLCBbXSwgJycsIHt3aWR0aDogJzgwdncnfSkNCiAgICBjb25zdCBkYyA9IGNyZWF0ZUVsZW1lbnQoZGlhbG9nLCAnZGl2JywgWydkLWZsZXgnLCAnZmxleC1jb2x1bW4nXSkNCiAgICBjb25zdCBoZWFkZXIgPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pDQogICAgY3JlYXRlRWxlbWVudChoZWFkZXIsICdoMicsIFtdLCB0aXRsZSkNCiAgICBjb25zdCBzZWxlY3RlZENvbnRlbnQgPSBjcmVhdGVFbGVtZW50KGRjLCAnZGl2JywgW10pDQogICAgLy8gY3JlYXRlRWxlbWVudChkYywgJ2hyJywgWyd3LTEwMCddKQ0KICAgIA0KICAgIC8vIGZpbHRlciB0ZXh0DQogICAgY29uc3QgZmlsdGVyID0gY3JlYXRlRWxlbWVudChkYywgJ2lucHV0JywgWydmb3JtLWNvbnRyb2wnLCAnbXQtMicsICdtYi0yJ10pDQogICAgZmlsdGVyLnBsYWNlaG9sZGVyID0gIkZpbHRlciINCiAgICANCiAgICBjb25zdCBtYWluID0gY3JlYXRlRWxlbWVudChkYywgJ2RpdicsIFsnZC1mbGV4JywgJ292ZXJmbG93LWF1dG8nLCAnZmxleC13cmFwJ10pDQogICAgY3JlYXRlRWxlbWVudChkYywgJ2hyJywgWyd3LTEwMCddKQ0KICAgIGNvbnN0IGFsZXJ0ID0gY3JlYXRlRWxlbWVudChkYywgJ2RpdicsIFsnYWxlcnQnLCAnYWxlcnQtZGFuZ2VyJywgJ2Qtbm9uZSddKQ0KICAgIGNvbnN0IGZvb3RlciA9IGNyZWF0ZUVsZW1lbnQoZGMsICdkaXYnLCBbJ2QtZmxleCcsICdqdXN0aWZ5LWNvbnRlbnQtY2VudGVyJ10pDQogICAgY29uc3Qgb2tCdG4gPSBjcmVhdGVFbGVtZW50KGZvb3RlciwgJ2J1dHRvbicsIFsnYnRuJywgJ2J0bi1wcmltYXJ5JywgJ21lLTInXSwgJ09LJykNCg0KICAgIGxldCBzZWxlY3RlZCA9IG9wdGlvbnMuaW5pdGlhbFNlbGVjdGlvbiB8fCBbXQ0KDQogICAgZnVuY3Rpb24gc3luY1NlbGVjdGVkKCkgew0KICAgICAgICBzZWxlY3RlZENvbnRlbnQuaW5uZXJIVE1MID0gJycNCiAgICAgICAgY3JlYXRlRWxlbWVudChzZWxlY3RlZENvbnRlbnQsICdzcGFuJywgWydtLTEnXSwgJ1NlbGVjdGVkOiAnLCB7Y29sb3I6ICdibHVlJ30pDQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWQubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBzZWxlY3RlZFtpXQ0KICAgICAgICAgICAgY29uc3QgdGV4dCA9IG9wdGlvbnMucHJlc2VydmVPcmRlciA/IGAke2kgKyAxfTogJHtpdGVtfWAgOiBpdGVtDQogICAgICAgICAgICBjcmVhdGVFbGVtZW50KHNlbGVjdGVkQ29udGVudCwgJ3NwYW4nLCBbJ20tMSddLCB0ZXh0KQ0KICAgICAgICB9DQoNCiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIG1haW4uY2hpbGRyZW4pIHsNCiAgICAgICAgICAgIGNvbnN0IHNwYW4gPSBpdGVtIGFzIEhUTUxTcGFuRWxlbWVudA0KICAgICAgICAgICAgY29uc3QgaXNJdGVtU2VsZWN0ZWQgPSBzZWxlY3RlZC5pbmNsdWRlcyhpdGVtLnRleHRDb250ZW50ISkNCiAgICAgICAgICAgIHNwYW4uY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnLCBpc0l0ZW1TZWxlY3RlZCkNCiAgICAgICAgICAgIHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gaXNJdGVtU2VsZWN0ZWQgPyAncmdiYSgwLCAxMjMsIDI1NSwgMC41KScgOiAncmdiKDI0NCwgMjQ0LCAyNDQpJw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yIChjb25zdCBpdGVtIG9mIGRhdGEpIHsNCiAgICAgICAgY29uc3Qgc3BhbiA9IGNyZWF0ZUVsZW1lbnQobWFpbiwgJ3NwYW4nLCBbJ211bHRpLXNlbGVjdCcsICdyb3VuZGVkLTEnLCAncC0xJywgJ20tMSddLCBpdGVtKQ0KICAgICAgICBzcGFuLnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIg0KICAgICAgICBzcGFuLm9uY2xpY2sgPSAoKSA9PiB7DQogICAgICAgICAgICBjb25zdCBvbGRTZWxlY3Rpb24gPSBbLi4uc2VsZWN0ZWRdDQogICAgICAgICAgICBjb25zdCBuZXdTZWxlY3Rpb24gPSBvcHRpb25zLnNpbmdsZVNlbGVjdCA/IFtpdGVtXSA6IChzZWxlY3RlZC5pbmNsdWRlcyhpdGVtKSA/IHNlbGVjdGVkLmZpbHRlcihpID0+IGkgIT09IGl0ZW0pIDogWy4uLnNlbGVjdGVkLCBpdGVtXSkNCiAgICAgICAgICAgIGNvbnN0IHIgPSBvcHRpb25zLmNoZWNrZXI/LihvbGRTZWxlY3Rpb24sIG5ld1NlbGVjdGlvbikNCiAgICAgICAgICAgIGlmICh0eXBlb2YgciA9PT0gJ3N0cmluZycpIHsNCiAgICAgICAgICAgICAgICAvLyBpbnZhbGlkIHN0YXRlDQogICAgICAgICAgICAgICAgYWxlcnQudGV4dENvbnRlbnQgPSByDQogICAgICAgICAgICAgICAgYWxlcnQuY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJykNCiAgICAgICAgICAgICAgICBva0J0bi5kaXNhYmxlZCA9IHRydWUNCiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IG5ld1NlbGVjdGlvbg0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAvLyBmaXhlZCBzdGF0ZQ0KICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gciB8fCBuZXdTZWxlY3Rpb24NCiAgICAgICAgICAgICAgICBhbGVydC5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKQ0KICAgICAgICAgICAgICAgIG9rQnRuLmRpc2FibGVkID0gZmFsc2UNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHN5bmNTZWxlY3RlZCgpDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmaWx0ZXIub25pbnB1dCA9ICgpID0+IHsNCiAgICAgICAgY29uc3QgdiA9IGZpbHRlci52YWx1ZS50b0xvd2VyQ2FzZSgpDQogICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBtYWluLmNoaWxkcmVuKSB7DQogICAgICAgICAgICBpZiAoaXRlbS50ZXh0Q29udGVudD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2KSkgew0KICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJykNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgbGV0IHJlc29sdmVyOiAoKHZhbHVlOiBzdHJpbmdbXXx1bmRlZmluZWQpID0+IHZvaWQpDQogICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlPHN0cmluZ1tdfHVuZGVmaW5lZD4oKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICByZXNvbHZlciA9IHJlc29sdmUNCiAgICB9KQ0KDQogICAgb2tCdG4ub25jbGljayA9ICgpID0+IHsNCiAgICAgICAgZGlhbG9nLmNsb3NlKCkNCiAgICAgICAgZGlhbG9nLnJlbW92ZSgpDQogICAgICAgIHJlc29sdmVyKHNlbGVjdGVkKQ0KICAgIH0NCg0KICAgIC8vIGhhbmRsZSBlc2Mga2V5IHRvIGNsb3NlIHRoZSBkaWFsb2cNCiAgICBkaWFsb2cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7DQogICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHsNCiAgICAgICAgICAgIGRpYWxvZy5jbG9zZSgpDQogICAgICAgICAgICBkaWFsb2cucmVtb3ZlKCkNCiAgICAgICAgICAgIHJlc29sdmVyKHVuZGVmaW5lZCkNCiAgICAgICAgfQ0KICAgIH0pDQoNCiAgICBzeW5jU2VsZWN0ZWQoKQ0KICAgIGRpYWxvZy5zaG93TW9kYWwoKQ0KICAgIHJldHVybiBwcm9taXNlDQp9DQoNCmV4cG9ydCB0eXBlIFRhYmxlQ29sdW1uUHJvcGVydHkgPSB7DQogICAgZm9ybWF0ZXI/OiAodmFsdWU6IGFueSkgPT4gc3RyaW5nIHwgSFRNTEVsZW1lbnQNCiAgICBzdHlsZT86IFBhcnRpYWw8Q1NTU3R5bGVEZWNsYXJhdGlvbj4NCn0NCmV4cG9ydCB0eXBlIFRhYmxlUHJlc2VudGF0aW9uID0gew0KICAgIGNvbHVtbnM6IHN0cmluZ1tdDQogICAgY29sdW1uUHJvcGVydGllczogUmVjb3JkPHN0cmluZywgVGFibGVDb2x1bW5Qcm9wZXJ0eT4NCiAgICBzb3J0Qnk6IHsNCiAgICAgICAgY29sdW1uOiBzdHJpbmcNCiAgICAgICAgb3JkZXI6ICdhc2MnIHwgJ2Rlc2MnDQogICAgfVtdDQoNCiAgICAvLyBJZiBub3QgZW1wdHksIHJhdyBpbmRleCB3aWxsIGJlIHNob3duIGluIHRoZSBmaXJzdCBjb2x1bW4gd2l0aCB0aGUgZ2l2ZW4gbmFtZQ0KICAgIC8vIG5vdGU6IHRoaXMgY29sdW1uIGNhbiBiZSBoaWRlIC8gc29ydCBhcyB3ZWxsDQogICAgLy8gdHlwaWNhbCB1c2FnZXMgaXMgcGFzc2luZyBhICcjJyBoZXJlDQogICAgcmF3SW5kZXhDb2x1bW46IHN0cmluZw0KDQogICAgcGFnZVNpemU/OiBudW1iZXINCiAgICBvblJvd0NsaWNrOiAoaXRlbTogYW55KSA9PiB2b2lkDQogICAgc3RhdGVLZXk6IHN0cmluZyAvLyB1c2VkIHRvIHNhdmUgdGhlIHN0YXRlIG9mIHRoZSB0YWJsZSBpbiBsb2NhbCBzdG9yYWdlDQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWJsZUZyb21BcnJheShhcnI6IGFueVtdLCBwcmVzZW50YXRpb246IFBhcnRpYWw8VGFibGVQcmVzZW50YXRpb24+ID0ge30pIHsNCiAgICAvLyBoZWxwZXIgZnVuY3Rpb25zDQogICAgY29uc3QgdG9BcnJvdyA9IChzOiBzdHJpbmcpID0+IHMgPT09ICdhc2MnID8gJ+Kshu+4jycgOiAn4qyH77iPJw0KICAgIGNvbnN0IGZyb21BcnJvdyA9IChzOiBzdHJpbmcpID0+IHMgPT09ICfirIbvuI8nID8gJ2FzYycgOiAnZGVzYycNCiAgICBjb25zdCBkZWZhdWx0Q29sdW1uRm9ybWF0ZXIgPSAodmFsdWU6IGFueSkgPT4gew0KICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCkgew0KICAgICAgICAgICAgcmV0dXJuIHR1LnNhZmVFeGVjdXRlKCgpID0+IEpTT04uc3RyaW5naWZ5KHZhbHVlLCBudWxsLCAyKSwgZSA9PiBgJHtlfWApDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gdmFsdWUgfHwgJycNCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICAvLyBvdmVyYWxsIGRvbQ0KICAgIGNvbnN0IHZpZXcgPSBjcmVhdGVFbGVtZW50KG51bGwsICdkaXYnKQ0KICAgIGNvbnN0IHRvb2xiYXIgPSBjcmVhdGVFbGVtZW50KHZpZXcsICdkaXYnLCBbJ2lucHV0LWdyb3VwJywgJ21iLTMnXSkNCiAgICBjb25zdCBmaWVsZFNlbGVjdCA9IGNyZWF0ZUVsZW1lbnQodG9vbGJhciwgJ2J1dHRvbicsIFsnYnRuJywgJ2J0bi1wcmltYXJ5JywgJ21lLTInXSwgJ0NvbHVtbnMnKQ0KICAgIGNvbnN0IHNvcnRCdG4gPSBjcmVhdGVFbGVtZW50KHRvb2xiYXIsICdidXR0b24nLCBbJ2J0bicsICdidG4tcHJpbWFyeSddLCAnU29ydCcpDQogICAgY29uc3Qgc29ydEhpbnQgPSBjcmVhdGVFbGVtZW50KHRvb2xiYXIsICdzcGFuJywgWydpbnB1dC1ncm91cC10ZXh0JywgJ21lLTInXSwgJycpDQogICAgY3JlYXRlRWxlbWVudCh0b29sYmFyLCAnc3BhbicsIFsnaW5wdXQtZ3JvdXAtdGV4dCddLCAnRmlsdGVyJykNCiAgICBjb25zdCBmaWx0ZXIgPSBjcmVhdGVFbGVtZW50KHRvb2xiYXIsICdpbnB1dCcsIFsnZm9ybS1jb250cm9sJ10sICcnKQ0KICAgIGNvbnN0IGNvdW50cyA9IGNyZWF0ZUVsZW1lbnQodG9vbGJhciwgJ3NwYW4nLCBbJ2lucHV0LWdyb3VwLXRleHQnXSwgJzIwIC8gMTAwJykNCg0KICAgIC8vIG5vdyBwYWdpbmcgc2VjdGlvbiwgd2hpY2ggbG9va3MgbGlrZSA0IGJ1dHRvbnMgYW5kIGFuIGVkaXQ6ICI8PCA8IFs4XSA+ID4+DQogICAgY29uc3QgcGFnaW5nID0gY3JlYXRlRWxlbWVudCh0b29sYmFyLCAnZGl2JywgWydidG4tZ3JvdXAnXSkNCiAgICBjb25zdCBmaXJzdEJ0biA9IGNyZWF0ZUVsZW1lbnQocGFnaW5nLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXByaW1hcnknLCAnbXMtMiddLCAnPDwnKQ0KICAgIGNvbnN0IHByZXZCdG4gPSBjcmVhdGVFbGVtZW50KHBhZ2luZywgJ2J1dHRvbicsIFsnYnRuJywgJ2J0bi1wcmltYXJ5J10sICc8JykNCiAgICBjb25zdCBwYWdlVGV4dCA9IGNyZWF0ZUVsZW1lbnQocGFnaW5nLCAnYnV0dG9uJywgWydidG4nLCAnYnRuLXNlY29uZGFyeSddLCAnMjAgKiAyLzUnKQ0KICAgIGNvbnN0IG5leHRCdG4gPSBjcmVhdGVFbGVtZW50KHBhZ2luZywgJ2J1dHRvbicsIFsnYnRuJywgJ2J0bi1wcmltYXJ5J10sICc+JykNCiAgICBjb25zdCBsYXN0QnRuID0gY3JlYXRlRWxlbWVudChwYWdpbmcsICdidXR0b24nLCBbJ2J0bicsICdidG4tcHJpbWFyeSddLCAnPj4nKQ0KDQoNCiAgICBjb25zdCB0YWJsZSA9IGNyZWF0ZUVsZW1lbnQodmlldywgJ3RhYmxlJywgWyd0YWJsZScsICd0YWJsZS1zdHJpcGVkJywgJ3RhYmxlLWJvcmRlcmVkJywgJ3RhYmxlLWhvdmVyJ10pDQogICAgY29uc3QgdGhlYWQgPSBjcmVhdGVFbGVtZW50KHRhYmxlLCAndGhlYWQnKQ0KICAgIGNvbnN0IHRib2R5ID0gY3JlYXRlRWxlbWVudCh0YWJsZSwgJ3Rib2R5JykNCg0KICAgIC8vIGxvY2FsIHN0YXRlcw0KICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbcHJlc2VudGF0aW9uLnJhd0luZGV4Q29sdW1uLCAuLi50dS5kYXRhUHJvcGVydGllcyhhcnIpXS5maWx0ZXIoQm9vbGVhbikgYXMgc3RyaW5nW10NCiAgICBsZXQgY3VycmVudFBhZ2UgPSAwIC8vIHBhZ2Ugd29uJ3QgYmUgcGVyc2lzdGVkDQogICAgbGV0IHRvdGFsVmlzaWJsZSA9IDAgLy8gdG90YWwgdmlzaWJsZSByb3dzLCB1c2VkIGZvciBwYWdpbmcNCiAgICBjb25zdCBzdGF0ZSA9IHR1LmNyZWF0ZVN0YXRlKHByZXNlbnRhdGlvbiwgWydjb2x1bW5zJywgJ3NvcnRCeSddLCBwcmVzZW50YXRpb24uc3RhdGVLZXkpDQoNCiAgICB0eXBlIFJvdyA9IEhUTUxUYWJsZVJvd0VsZW1lbnQgJiB7IHJhd0luZGV4OiBudW1iZXIgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIGNvbnN0cnVjdFRhYmxlKCkgew0KICAgICAgICBjb25zdCB0ciA9IGNyZWF0ZUVsZW1lbnQodGhlYWQsICd0cicsIFtdKQ0KICAgICAgICBmb3IgKGNvbnN0IHByb3Agb2YgcHJvcGVydGllcykgew0KICAgICAgICAgICAgY29uc3QgdGggPSBjcmVhdGVFbGVtZW50KHRyLCAndGgnLCBbXSwgcHJvcCwge2N1cnNvcjogJ3BvaW50ZXInLCB1c2VyU2VsZWN0OiAnbm9uZSd9KQ0KICAgICAgICAgICAgdGgub25jbGljayA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBzID0gc3RhdGUuc29ydEJ5Py5maW5kKHMgPT4gcy5jb2x1bW4gPT09IHByb3ApDQogICAgICAgICAgICAgICAgaWYgKHMpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHMub3JkZXIgPT09ICdhc2MnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5zb3J0QnkgPSBbe2NvbHVtbjogcHJvcCwgb3JkZXI6ICdkZXNjJ31dDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocy5vcmRlciA9PT0gJ2Rlc2MnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5zb3J0QnkgPSBbXQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgc3RhdGUuc29ydEJ5ID0gW3tjb2x1bW46IHByb3AsIG9yZGVyOiAnYXNjJ31dDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGFwcGx5U29ydCgpDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICANCiAgICAgICAgLy8gY3JlYXRlIHRoZSB0YWJsZSBib2R5DQogICAgICAgIGZvciAoY29uc3QgW2ksIGl0ZW1dIG9mIGFyci5lbnRyaWVzKCkpIHsNCiAgICAgICAgICAgIGNvbnN0IHRyID0gY3JlYXRlRWxlbWVudCh0Ym9keSwgJ3RyJywgW10pOw0KICAgICAgICAgICAgKHRyIGFzIFJvdykucmF3SW5kZXggPSBpDQogICAgICAgICAgICBmb3IgKGNvbnN0IHByb3Agb2YgcHJvcGVydGllcykgew0KICAgICAgICAgICAgICAgIGNvbnN0IHRkID0gY3JlYXRlRWxlbWVudCh0ciwgJ3RkJywgW10sICcnLCBwcmVzZW50YXRpb24uY29sdW1uUHJvcGVydGllcz8uW3Byb3BdPy5zdHlsZSkNCiAgICAgICAgICAgICAgICBjb25zdCB2ID0gaXRlbVtwcm9wXQ0KICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdGVyID0gcHJlc2VudGF0aW9uLmNvbHVtblByb3BlcnRpZXM/Lltwcm9wXT8uZm9ybWF0ZXIgfHwgZGVmYXVsdENvbHVtbkZvcm1hdGVyDQogICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSAocHJvcCA9PT0gcHJlc2VudGF0aW9uLnJhd0luZGV4Q29sdW1uKT8gYCR7aX1gIDogZm9ybWF0ZXIodikNCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZvcm1hdHRlZFZhbHVlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgICB0ZC50ZXh0Q29udGVudCA9IGZvcm1hdHRlZFZhbHVlDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZvcm1hdHRlZFZhbHVlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGQuYXBwZW5kQ2hpbGQoZm9ybWF0dGVkVmFsdWUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgIA0KICAgICAgICAgICAgaWYgKHByZXNlbnRhdGlvbi5vblJvd0NsaWNrKSB7DQogICAgICAgICAgICAgICAgdHIub25jbGljayA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgcHJlc2VudGF0aW9uLm9uUm93Q2xpY2shKGl0ZW0pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRyLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZ290b1BhZ2UocGFnZTogbnVtYmVyKSB7DQogICAgICAgIGNvbnN0IHBhZ2VTaXplID0gcHJlc2VudGF0aW9uLnBhZ2VTaXplIHx8IEluZmluaXR5DQogICAgICAgIGNvbnN0IGxhc3RQYWdlID0gTWF0aC5mbG9vcih0b3RhbFZpc2libGUgLyBwYWdlU2l6ZSkNCiAgICAgICAgaWYgKHBhZ2UgPCAwKSBwYWdlID0gMA0KICAgICAgICBpZiAocGFnZSA+IGxhc3RQYWdlKSBwYWdlID0gbGFzdFBhZ2UNCiAgICAgICAgY3VycmVudFBhZ2UgPSBwYWdlDQogICAgICAgIGFwcGx5UGFnaW5nKCkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhcHBseVBhZ2luZygpIHsNCiAgICAgICAgY29uc3QgcGFnZVNpemUgPSBwcmVzZW50YXRpb24ucGFnZVNpemUgfHwgSW5maW5pdHkNCiAgICAgICAgLy8gb25seSB2aXNpYmxlIHJvd3MgZmFsbGluZyBpbnRvIHRoZSBjdXJyZW50IHBhZ2UgYXJlIHNob3duLCBhbGwgb3RoZXJzIGFyZSBoaWRkZW4NCiAgICAgICAgbGV0IHBvcyA9IDANCiAgICAgICAgZm9yIChjb25zdCByb3cgb2YgdGJvZHkuY2hpbGRyZW4pIHsNCiAgICAgICAgICAgIGNvbnN0IHIgPSByb3cgYXMgUm93DQoNCiAgICAgICAgICAgIGlmIChyLmNsYXNzTGlzdC5jb250YWlucygnaW52aXNpYmxlJykpIHsNCiAgICAgICAgICAgICAgICByLmNsYXNzTGlzdC50b2dnbGUoJ2Qtbm9uZScsIHRydWUpDQogICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgY29uc3QgcGFnZSA9IE1hdGguZmxvb3IocG9zIC8gcGFnZVNpemUpDQogICAgICAgICAgICBpZiAocGFnZSA9PT0gY3VycmVudFBhZ2UpIHsNCiAgICAgICAgICAgICAgICByLmNsYXNzTGlzdC50b2dnbGUoJ2Qtbm9uZScsIGZhbHNlKQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByLmNsYXNzTGlzdC50b2dnbGUoJ2Qtbm9uZScsIHRydWUpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBwb3MrKw0KICAgICAgICB9DQogICAgICAgIHBhZ2VUZXh0LnRleHRDb250ZW50ID0gYCR7Y3VycmVudFBhZ2UgKyAxfSAvICR7TWF0aC5jZWlsKHRvdGFsVmlzaWJsZSAvIHByZXNlbnRhdGlvbi5wYWdlU2l6ZSEpfWANCiAgICAgICAgaWYgKCFwcmVzZW50YXRpb24ucGFnZVNpemUpIHsNCiAgICAgICAgICAgIHBhZ2luZy5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gYXBwbHlGaWx0ZXIoczogc3RyaW5nKSB7DQogICAgICAgIHRvdGFsVmlzaWJsZSA9IDANCiAgICAgICAgbGV0IHRvdGFsID0gMA0KICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGJvZHkuY2hpbGRyZW4pIHsNCiAgICAgICAgICAgIGxldCBtZWV0ID0gZmFsc2UNCiAgICAgICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiBpdGVtLmNoaWxkcmVuKSB7DQogICAgICAgICAgICAgICAgaWYgKGNlbGwudGV4dENvbnRlbnQ/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocykpIHsNCiAgICAgICAgICAgICAgICAgICAgbWVldCA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0b3RhbCsrDQogICAgICAgICAgICB0b3RhbFZpc2libGUgKz0gKG1lZXQgPyAxIDogMCkNCiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnaW52aXNpYmxlJywgIW1lZXQpDQogICAgICAgIH0NCiAgICAgICAgY291bnRzLnRleHRDb250ZW50ID0gYCR7dG90YWxWaXNpYmxlfSAvICR7dG90YWx9YA0KICAgICAgICBjdXJyZW50UGFnZSA9IDANCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzaG93aGlkZUNvbHVtbnMoKSB7DQogICAgICAgIGZvckVhY2hUYWJsZUNlbGwodGFibGUsIChjZWxsLCByb3csIGNvbCkgPT4gew0KICAgICAgICAgICAgY2VsbC5zdHlsZS5kaXNwbGF5ID0gKHN0YXRlLmNvbHVtbnM/P3Byb3BlcnRpZXMpLmluY2x1ZGVzKHByb3BlcnRpZXNbY29sXSkgPyAnJyA6ICdub25lJw0KICAgICAgICB9KQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGFwcGx5U29ydCgpIHsNCiAgICAgICAgLy8gdXBkYXRlIHNvcnQgaGludA0KICAgICAgICBjb25zdCBzb3J0QnkgPSBzdGF0ZS5zb3J0QnkgfHwgW10NCiAgICAgICAgc29ydEhpbnQudGV4dENvbnRlbnQgPSBgJHtzb3J0QnkubWFwKHMgPT4gYCR7cy5jb2x1bW59ICR7dG9BcnJvdyhzLm9yZGVyKX1gKS5qb2luKCcsICcpfWANCiAgICAgICAgDQogICAgICAgIC8vIHVwZGF0ZSB0YWJsZSBoZWFkZXIgdG8gc2hvdyBzb3J0ICYgb3JkZXINCiAgICAgICAgZm9yIChjb25zdCBbaW5kZXgsIHByb3BdIG9mIHByb3BlcnRpZXMuZW50cmllcygpKSB7DQogICAgICAgICAgICBjb25zdCB0aCA9IHRoZWFkLmNoaWxkcmVuWzBdLmNoaWxkcmVuW2luZGV4XSBhcyBIVE1MVGFibGVDZWxsRWxlbWVudA0KICAgICAgICAgICAgdGguaW5uZXJIVE1MID0gJycgLy8gY2xlYXIgdGhlIGhlYWRlciBjb250ZW50DQogICAgICAgICAgICBjcmVhdGVFbGVtZW50KHRoLCAnc3BhbicsIFtdLCBwcm9wKQ0KICAgICAgICAgICAgY29uc3QgaSA9IHNvcnRCeS5maW5kSW5kZXgocyA9PiBzLmNvbHVtbiA9PT0gcHJvcCkNCiAgICAgICAgICAgIGlmIChpID49IDApIHsNCiAgICAgICAgICAgICAgICBjb25zdCBzID0gc29ydEJ5W2ldDQogICAgICAgICAgICAgICAgY3JlYXRlRWxlbWVudCh0aCwgJ3NwYW4nLCBbXSwgdG9BcnJvdyhzLm9yZGVyKSkNCiAgICAgICAgICAgICAgICBpZiAoc29ydEJ5Lmxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlRWxlbWVudCh0aCwgJ3NwYW4nLCBbXSwgYCR7aSArIDF9YCwge3ZlcnRpY2FsQWxpZ246ICdzdXBlcicsIGZvbnRTaXplOiAnMC44ZW0nfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBzb3J0IHRoZSB0YWJsZSByb3dzDQogICAgICAgIGNvbnN0IHJvd3MgPSBBcnJheS5mcm9tKHRib2R5LmNoaWxkcmVuKSBhcyBSb3dbXQ0KICAgICAgICBpZiAoc29ydEJ5Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIHJvd3Muc29ydCgoYSwgYikgPT4gew0KICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBzb3J0QnkpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgYVZhbHVlID0gKHMuY29sdW1uID09PSBwcmVzZW50YXRpb24ucmF3SW5kZXhDb2x1bW4pPyBhLnJhd0luZGV4IDogYXJyW2EucmF3SW5kZXhdW3MuY29sdW1uXQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBiVmFsdWUgPSAocy5jb2x1bW4gPT09IHByZXNlbnRhdGlvbi5yYXdJbmRleENvbHVtbik/IGIucmF3SW5kZXggOiBhcnJbYi5yYXdJbmRleF1bcy5jb2x1bW5dDQogICAgICAgICAgICAgICAgICAgIGlmIChhVmFsdWUgPCBiVmFsdWUpIHJldHVybiBzLm9yZGVyID09PSAnYXNjJyA/IC0xIDogMQ0KICAgICAgICAgICAgICAgICAgICBpZiAoYVZhbHVlID4gYlZhbHVlKSByZXR1cm4gcy5vcmRlciA9PT0gJ2FzYycgPyAxIDogLTENCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIDANCiAgICAgICAgICAgIH0pDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByb3dzLnNvcnQoKGEsIGIpID0+IGEucmF3SW5kZXggLSBiLnJhd0luZGV4KQ0KICAgICAgICB9DQoNCiAgICAgICAgdGJvZHkuaW5uZXJIVE1MID0gJycNCiAgICAgICAgdGJvZHkuYXBwZW5kKC4uLnJvd3MpDQogICAgICAgIGFwcGx5UGFnaW5nKCkNCiAgICB9DQoNCiAgICBmaWVsZFNlbGVjdC5vbmNsaWNrID0gYXN5bmMgKCkgPT4gew0KICAgICAgICBjb25zdCByID0gYXdhaXQgc2hvd1NlbGVjdGlvbignU2VsZWN0IEZpZWxkcycsIHByb3BlcnRpZXMsIHtpbml0aWFsU2VsZWN0aW9uOiBzdGF0ZS5jb2x1bW5zPz9wcm9wZXJ0aWVzfSkNCiAgICAgICAgaWYgKHIgPT09IHVuZGVmaW5lZCkgcmV0dXJuDQoNCiAgICAgICAgLy8gTm90ZTogc2VsZWN0IGFsbCBtZWFucyBub3QganVzdCBzZWxlY3QgYWxsIHRoaXMgdGltZSwgYnV0IGZvciBmdXR1cmUgYXMgd2VsbA0KICAgICAgICAvLyAgICAgICBzbyB3ZSBjYW5ub3QganVzdCBzYXZlIHRoZSBjdXJyZW50IGZ1bGwgc2V0IG9mIHByb3BlcnRpZXMNCiAgICAgICAgLy8gICAgICAgd2UgbmVlZCB0byBzYXZlIGB1bmRlZmluZWRgIHRvIGV4cHJlc3MgdGhpcyBzZW1hbnRpY3MNCiAgICAgICAgLy8gVE9ETzogZmluZCBhIG1vcmUgZGVzY3JpcHRpdmUgd2F5DQogICAgICAgIHN0YXRlLmNvbHVtbnMgPSAoci5sZW5ndGggPT09IHByb3BlcnRpZXMubGVuZ3RoKT8gdW5kZWZpbmVkIDogcg0KICAgICAgICBzaG93aGlkZUNvbHVtbnMoKQ0KICAgIH0NCg0KICAgIHNvcnRCdG4ub25jbGljayA9IGFzeW5jICgpID0+IHsNCiAgICAgICAgLy8gY29uc3RydWN0IGFsbCBwcm9wZXJ0aWVzDQogICAgICAgIGNvbnN0IGFsbE9wdGlvbnMgPSBwcm9wZXJ0aWVzLm1hcChwID0+IFtgJHtwfSAke3RvQXJyb3coJ2FzYycpfWAsIGAke3B9ICR7dG9BcnJvdygnZGVzYycpfWBdKS5mbGF0KCkNCiAgICAgICAgY29uc3Qgc29ydE9wdGlvbnMgPSBzdGF0ZS5zb3J0Qnk/Lm1hcChzID0+IGAke3MuY29sdW1ufSAke3RvQXJyb3cocy5vcmRlcil9YCkNCiAgICAgICAgY29uc3QgY2hlY2tlciA9IChvbGRTZWxlY3Rpb246IHN0cmluZ1tdLCBuZXdTZWxlY3Rpb246IHN0cmluZ1tdKSA9PiB7DQogICAgICAgICAgICBpZiAobmV3U2VsZWN0aW9uLmxlbmd0aCA+IG9sZFNlbGVjdGlvbi5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAvLyBhIG5ldyBzb3J0IGlzIGFkZGVkLCB3ZSB3aWxsIG1ha2Ugc3VyZSB0byByZW1vdmUgb2xkIGR1cGxpY2F0ZXMgaWYgdGhlcmUgaXMNCiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gbmV3U2VsZWN0aW9uW25ld1NlbGVjdGlvbi5sZW5ndGggLSAxXQ0KICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IGl0ZW0uc3BsaXQoJyAnKVswXQ0KICAgICAgICAgICAgICAgIHJldHVybiBvbGRTZWxlY3Rpb24uZmlsdGVyKHMgPT4gcy5zcGxpdCgnICcpWzBdICE9PSBrZXkpLmNvbmNhdChbaXRlbV0pDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbmV3U2VsZWN0aW9uDQogICAgICAgfQ0KICAgICAgICBjb25zdCByID0gYXdhaXQgc2hvd1NlbGVjdGlvbignU29ydCBCeScsIGFsbE9wdGlvbnMsIHtwcmVzZXJ2ZU9yZGVyOiB0cnVlLCBpbml0aWFsU2VsZWN0aW9uOiBzb3J0T3B0aW9ucywgY2hlY2tlcn0pDQogICAgICAgIGlmIChyID09PSB1bmRlZmluZWQpIHJldHVybg0KICAgICAgICBzdGF0ZS5zb3J0QnkgPSByLm1hcChzID0+IHsNCiAgICAgICAgICAgIGNvbnN0IFtjb2x1bW4sIG9yZGVyXSA9IHMuc3BsaXQoJyAnKQ0KICAgICAgICAgICAgcmV0dXJuIHtjb2x1bW4sIG9yZGVyOiBmcm9tQXJyb3cob3JkZXIpIGFzICdhc2MnIHwgJ2Rlc2MnfQ0KICAgICAgICB9KQ0KICAgICAgICBhcHBseVNvcnQoKQ0KICAgIH0NCg0KICAgIGZpbHRlci5vbmlucHV0ID0gKCkgPT4gew0KICAgICAgICBjb25zdCB2ID0gZmlsdGVyLnZhbHVlLnRvTG93ZXJDYXNlKCkNCiAgICAgICAgYXBwbHlGaWx0ZXIodikNCiAgICAgICAgYXBwbHlQYWdpbmcoKQ0KICAgIH0NCg0KICAgIHBhZ2VUZXh0Lm9uY2xpY2sgPSAoKSA9PiB7DQogICAgICAgIGNvbnN0IHBhZ2UgPSBOdW1iZXIocHJvbXB0KCdQYWdlIHNpemUnLCBgJHtwcmVzZW50YXRpb24ucGFnZVNpemUgfHwgMjB9YCkpDQogICAgICAgIGdvdG9QYWdlKHBhZ2UgLSAxKQ0KICAgIH0NCiAgICBmaXJzdEJ0bi5vbmNsaWNrID0gKCkgPT4gZ290b1BhZ2UoMCkNCiAgICBwcmV2QnRuLm9uY2xpY2sgPSAoKSA9PiBnb3RvUGFnZShjdXJyZW50UGFnZSAtIDEpDQogICAgbmV4dEJ0bi5vbmNsaWNrID0gKCkgPT4gZ290b1BhZ2UoY3VycmVudFBhZ2UgKyAxKQ0KICAgIGxhc3RCdG4ub25jbGljayA9ICgpID0+IGdvdG9QYWdlKEluZmluaXR5KQ0KDQogICAgLy8gbG9naWMgc3RhcnQgaGVyZQ0KICAgIGNvbnN0cnVjdFRhYmxlKCkNCiAgICBzaG93aGlkZUNvbHVtbnMoKQ0KICAgIGFwcGx5RmlsdGVyKCcnKQ0KICAgIGFwcGx5U29ydCgpDQogICAgcmV0dXJuIHZpZXcNCn0NCg0K",
  "tu.ts": "Ly8gdHU6IGEgc2V0IG9mIHV0aWxpdHkgZnVuY3Rpb25zDQovLyBoYXNoOiAxYWQwODhmY2MzYjcxNTZkOTEwMjUwZjI0OGE2MTAzNjE0ZTg5NTY2OWY3NWI4YmI1YzMxM2M5OTRjZDFhNmNjDQovLyBQbGVhc2UgZG8gbm90IG1vZGlmeSB0aGlzIGZpbGUgZGlyZWN0bHkuIFVzZSB0aGUgZm9sbG93aW5nIGNvbW1hbmQgdG8gdXBkYXRlIHRoaXMgZmlsZSBvbiBhIGRlbm8gZW52aXJvbm1lbnQ6DQovLyBkZW5vIHJ1biAtQSAtLXJlbG9hZCBqc3I6QHRpbWVwcC91dS9pbnN0YWxsDQoNCg0KLy8vIGdldCB0aW1lIGFzIFlZWVktTU0tREQgSEg6bW06c3MNCi8vLyB0aW1lWm9uZU9mZnNldCBpcyBpbiBtaW51dGVzLCBlLmcuIA0KLy8gICAgIC00ODA6IGZvciBVVEMrOA0KLy8gICAgIDQ4MDogZm9yIFVUQy04DQovLyAgICAgMDogZm9yIFVUQw0KLy8gICAgIHVuZGVmaW5lZDogZm9yIGxvY2FsIGRldmljZSB0aW1lem9uZSAoc28gdGhlIHJlc3VsdCBjYW4gYmUgZGlmZmVyZW50IG9uIGRpZmZlcmVudCBkZXZpY2VzKQ0KZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFRpbWUoZDogRGF0ZSwgdGltZVpvbmVPZmZzZXQ/OiBudW1iZXIpOiBzdHJpbmcgew0KICAgIGNvbnN0IHQgPSBkLmdldFRpbWUoKQ0KICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0IC0gKHRpbWVab25lT2Zmc2V0Pz9kLmdldFRpbWV6b25lT2Zmc2V0KCkpICogNjAgKiAxMDAwKQ0KICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoJ1QnLCAnICcpDQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRGbG9hdChuOiBudW1iZXIsIGRpZ2l0cyA9IDIsIG1pbmludW1EaWdpdHMgPSAwKTogc3RyaW5nIHsNCiAgICByZXR1cm4gbi50b0xvY2FsZVN0cmluZyh1bmRlZmluZWQsIHsgDQogICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogbWluaW51bURpZ2l0cywgDQogICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogZGlnaXRzLA0KICAgICAgICB1c2VHcm91cGluZzogZmFsc2UsDQogICAgfSkNCn0NCg0KZXhwb3J0IGZ1bmN0aW9uIHRyaW1TdWZmaXgoc3RyOiBzdHJpbmcsIHN1ZmZpeDogc3RyaW5nKTogc3RyaW5nIHsNCiAgICBpZiAoc3RyLmVuZHNXaXRoKHN1ZmZpeCkpIHsNCiAgICAgICAgcmV0dXJuIHN0ci5zbGljZSgwLCAtc3VmZml4Lmxlbmd0aCk7DQogICAgfQ0KICAgIHJldHVybiBzdHI7DQp9DQoNCmV4cG9ydCBmdW5jdGlvbiB0cmltUHJlZml4KHN0cjogc3RyaW5nLCBwcmVmaXg6IHN0cmluZyk6IHN0cmluZyB7DQogICAgaWYgKHN0ci5zdGFydHNXaXRoKHByZWZpeCkpIHsNCiAgICAgICAgcmV0dXJuIHN0ci5zbGljZShwcmVmaXgubGVuZ3RoKTsNCiAgICB9DQogICAgcmV0dXJuIHN0cjsNCn0NCg0KZXhwb3J0IGZ1bmN0aW9uIHRyaW1FbXB0eUxpbmVzKHN0cjogc3RyaW5nLCAuLi5sb2NhdGlvbnM6ICgnaGVhZCcgfCAndGFpbCcgfCAnbWlkZGxlJylbXSk6IHN0cmluZyB7DQogICAgbGV0IGxpbmVzID0gc3RyLnNwbGl0KCdcbicpOw0KDQogICAgLy8gSGFuZGxlIGhlYWQgKGxlYWRpbmcpIGVtcHR5IGxpbmVzDQogICAgaWYgKGxvY2F0aW9ucy5pbmNsdWRlcygnaGVhZCcpKSB7DQogICAgICAgIGxpbmVzID0gbGluZXMuc2xpY2UobGluZXMuZmluZEluZGV4KGxpbmUgPT4gbGluZS50cmltKCkgIT09ICcnKSk7DQogICAgfQ0KDQogICAgLy8gSGFuZGxlIHRhaWwgKHRyYWlsaW5nKSBlbXB0eSBsaW5lcw0KICAgIGlmIChsb2NhdGlvbnMuaW5jbHVkZXMoJ3RhaWwnKSkgew0KICAgICAgICBsZXQgZW5kID0gbGluZXMubGVuZ3RoIC0gMTsNCiAgICAgICAgd2hpbGUgKGVuZCA+PSAwICYmIGxpbmVzW2VuZF0udHJpbSgpID09PSAnJykgew0KICAgICAgICAgICAgZW5kLS07DQogICAgICAgIH0NCiAgICAgICAgbGluZXMgPSBsaW5lcy5zbGljZSgwLCBlbmQgKyAxKTsNCiAgICB9DQoNCiAgICAvLyBIYW5kbGUgbWlkZGxlIGVtcHR5IGxpbmVzDQogICAgaWYgKGxvY2F0aW9ucy5pbmNsdWRlcygnbWlkZGxlJykpIHsNCiAgICAgICAgbGluZXMgPSBsaW5lcy5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSAhPT0gJycpOw0KICAgIH0NCg0KICAgIHJldHVybiBsaW5lcy5qb2luKCdcbicpOw0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gaW5kZW50VGV4dFdpdGhTcGFjZXModGV4dDogc3RyaW5nLCBzcGFjZXM6IG51bWJlcik6IHN0cmluZyB7DQogICAgY29uc3QgaW5kZW50ID0gJyAnLnJlcGVhdChzcGFjZXMpOw0KICAgIHJldHVybiB0ZXh0LnNwbGl0KCdcbicpLm1hcChsaW5lID0+IGluZGVudCArIGxpbmUpLmpvaW4oJ1xuJyk7DQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBnZXRJbmRlbnRpb24odGV4dDogc3RyaW5nKTogbnVtYmVyIHsNCiAgICBsZXQgaW5kZW50aW9uID0gMA0KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykgew0KICAgICAgICBpZiAodGV4dFtpXSA9PT0gJyAnKSB7DQogICAgICAgICAgICBpbmRlbnRpb24rKw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gaW5kZW50aW9uDQp9DQoNCmV4cG9ydCBmdW5jdGlvbiB1bkluZGVudFRleHRXaXRoU3BhY2VzKHRleHQ6IHN0cmluZywgc3BhY2VzOiBudW1iZXIpOiBzdHJpbmcgew0KICAgIC8vIGlmIHNwYWNlcyBpcyBtb3JlIHRoYW4gbGVhZGluZyBzcGFjZXMsIGp1c3QgcmVtb3ZlIGFsbCBsZWFkaW5nIHNwYWNlcw0KICAgIHJldHVybiB0ZXh0LnNwbGl0KCdcbicpLm1hcChsaW5lID0+IHsNCiAgICAgICAgY29uc3QgcmVtb3ZlQ291bnQgPSBNYXRoLm1pbihnZXRJbmRlbnRpb24obGluZSksIHNwYWNlcykNCiAgICAgICAgcmV0dXJuIGxpbmUuc2xpY2UocmVtb3ZlQ291bnQpOw0KICAgIH0pLmpvaW4oJ1xuJyk7DQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBoYXNoU3RyaW5nKHM6IHN0cmluZyk6IG51bWJlciB7DQogICAgbGV0IGhhc2ggPSAwOw0KICAgIGlmIChzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGhhc2g7DQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGhhc2ggPSAoaGFzaCA8PCA1KSAtIGhhc2g7DQogICAgICAgIGhhc2ggPSBoYXNoICsgcy5jaGFyQ29kZUF0KGkpOw0KICAgICAgICBoYXNoID0gaGFzaCAmIGhhc2g7DQogICAgfQ0KICAgIHJldHVybiBoYXNoOw0KfQ0KDQoNCmV4cG9ydCBmdW5jdGlvbiB0b0ZpbGVTeXN0ZW1Db21wYXRpYmxlTmFtZShuYW1lOiBzdHJpbmcpOiBzdHJpbmcgew0KICAgIC8vIDEuIFJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyBzcGFjZXMNCiAgICBuYW1lID0gbmFtZS50cmltKCkNCg0KICAgIC8vIDIuIFJlcGxhY2UgaW52YWxpZCBjaGFyYWN0ZXJzIHdpdGggdW5kZXJzY29yZXMNCiAgICBjb25zdCBpbnZhbGlkQ2hhcnMgPSAvWzw+OiIvXFx8PypdL2cNCiAgICBuYW1lID0gbmFtZS5yZXBsYWNlKGludmFsaWRDaGFycywgJ18nKQ0KDQogICAgLy8gMy4gTGltaXQgbGVuZ3RoIHRvIDI1NSBjaGFyYWN0ZXJzDQogICAgaWYgKG5hbWUubGVuZ3RoID4gMjU1KSB7DQogICAgICAgIG5hbWUgPSBuYW1lLnNsaWNlKDAsIDI1NSkNCiAgICB9DQoNCiAgICByZXR1cm4gbmFtZQ0KfQ0KDQpmdW5jdGlvbiB0cmF2ZXJzZU9iamVjdEludGVybmFsKG9iajogYW55LCBjYWxsYmFjazogKHBhdGg6IHN0cmluZ1tdLCB2YWx1ZTogYW55LCB0eXBlOiAnb2JqZWN0J3wnbGVhZid8J2xvb3AnKSA9PiB2b2lkLCBwYXRoOiBzdHJpbmdbXSwgc2Vlbk9iamVjdHM6IFdlYWtTZXQ8b2JqZWN0Pik6IHZvaWQgew0KICAgIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyB8fCBvYmogPT09IG51bGwpIHsNCiAgICAgICAgY2FsbGJhY2socGF0aCwgb2JqLCAnbGVhZicpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgaWYgKHNlZW5PYmplY3RzLmhhcyhvYmopKSB7DQogICAgICAgIGNhbGxiYWNrKHBhdGgsIG9iaiwgJ2xvb3AnKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBzZWVuT2JqZWN0cy5hZGQob2JqKTsNCiAgICAgICAgY2FsbGJhY2socGF0aCwgb2JqLCAnb2JqZWN0Jyk7DQogICAgICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikgew0KICAgICAgICAgICAgdHJhdmVyc2VPYmplY3RJbnRlcm5hbChvYmpba2V5XSwgY2FsbGJhY2ssIFsuLi5wYXRoLCBrZXldLCBzZWVuT2JqZWN0cyk7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmV4cG9ydCBmdW5jdGlvbiB0cmF2ZXJzZU9iamVjdChvYmo6IGFueSwgY2FsbGJhY2s6IChwYXRoOiBzdHJpbmdbXSwgdmFsdWU6IGFueSwgdHlwZTogJ29iamVjdCd8J2xlYWYnfCdsb29wJykgPT4gdm9pZCk6IHZvaWQgew0KICAgIGNvbnN0IHNlZW5PYmplY3RzID0gbmV3IFdlYWtTZXQ8b2JqZWN0PigpDQogICAgdHJhdmVyc2VPYmplY3RJbnRlcm5hbChvYmosIGNhbGxiYWNrLCBbXSwgc2Vlbk9iamVjdHMpDQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBkYXRhUHJvcGVydGllcyhhcnI6IG9iamVjdFtdKTogc3RyaW5nW10gew0KICAgIGNvbnN0IHByb3BTZXQgPSBuZXcgU2V0PHN0cmluZz4oKQ0KICAgIGZvciAoY29uc3QgaXRlbSBvZiBhcnIpIHsNCiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gaXRlbSkgew0KICAgICAgICAgICAgcHJvcFNldC5hZGQoa2V5KQ0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiBbLi4ucHJvcFNldF0NCn0NCg0KLy8gY2F0Y2ggYWxsIGV4Y3BldGlvbiBhbmQgcmV0dXJuIGEgZGVmYXVsdCB2YWx1ZSBpZiBlcnJvciBvY2N1cnMNCmV4cG9ydCBmdW5jdGlvbiBzYWZlRXhlY3V0ZTxUPihmbjogKCkgPT4gVCwgZGVmYXVsdFZhbHVlOiBUIHwgKChlOiB1bmtub3duKSA9PiBUKSk6IFQgew0KICAgIHRyeSB7DQogICAgICAgIHJldHVybiBmbigpDQogICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBpZiAodHlwZW9mIGRlZmF1bHRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJykgew0KICAgICAgICAgICAgcmV0dXJuIChkZWZhdWx0VmFsdWUgYXMgKGU6IHVua25vd24pID0+IFQpKGUpDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlDQogICAgICAgIH0NCiAgICB9DQp9DQoNCmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdGF0ZTxUIGV4dGVuZHMgb2JqZWN0PihvYmplY3Q6IFQsIHByb3BlcnRpZXM6IChrZXlvZiBUKVtdLCBzdGF0ZUtleT86IHN0cmluZyk6IFBpY2s8VCwgdHlwZW9mIHByb3BlcnRpZXNbbnVtYmVyXT4gew0KICAgIC8vIOWGhemDqOWtmOWCqOeahOeKtuaAgeWvueixoQ0KICAgIGNvbnN0IGludGVybmFsU3RhdGU6IFBhcnRpYWw8VD4gPSB7fTsNCg0KICAgIC8vIOWIneWni+WMliBpbnRlcm5hbFN0YXRl77yM5Y+q5YyF5ZCr5oyH5a6a55qE5bGe5oCnDQogICAgcHJvcGVydGllcy5mb3JFYWNoKChwcm9wKSA9PiB7DQogICAgICAgIGlmIChwcm9wIGluIG9iamVjdCkgew0KICAgICAgICAgICAgaW50ZXJuYWxTdGF0ZVtwcm9wXSA9IG9iamVjdFtwcm9wXTsNCiAgICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8g5a6a5LmJ5Luj55CG5a+56LGhDQogICAgY29uc3Qgc3RhdGUgPSBuZXcgUHJveHkoaW50ZXJuYWxTdGF0ZSwgew0KICAgICAgICBnZXQodGFyZ2V0OiBQYXJ0aWFsPFQ+LCBwcm9wOiBzdHJpbmcgfCBzeW1ib2wsIHJlY2VpdmVyOiBhbnkpIHsNCiAgICAgICAgICAgIC8vIOWwhiBwcm9wIOi9rOaNouS4uiBrZXlvZiBUIOexu+Wei++8jOW5tuajgOafpeaYr+WQpuWcqCBwcm9wZXJ0aWVzIOS4rQ0KICAgICAgICAgICAgY29uc3Qga2V5ID0gcHJvcCBhcyBrZXlvZiBUOw0KICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaW5jbHVkZXMoa2V5KSkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUHJvcGVydHkgJyR7U3RyaW5nKHByb3ApfScgaXMgbm90IG1hbmFnZWQgYnkgdGhpcyBzdGF0ZWApOw0KICAgICAgICAgICAgLy8gcmV0dXJuIHVuZGVmaW5lZDsgLy8g5pyq5oyH5a6a55qE5bGe5oCn6L+U5ZueIHVuZGVmaW5lZA0KICAgICAgICB9LA0KICAgICAgICBzZXQodGFyZ2V0OiBQYXJ0aWFsPFQ+LCBwcm9wOiBzdHJpbmcgfCBzeW1ib2wsIHZhbHVlOiBhbnkpIHsNCiAgICAgICAgICAgIC8vIOWwhiBwcm9wIOi9rOaNouS4uiBrZXlvZiBUIOexu+Wei++8jOW5tuajgOafpeaYr+WQpuWcqCBwcm9wZXJ0aWVzIOS4rQ0KICAgICAgICAgICAgY29uc3Qga2V5ID0gcHJvcCBhcyBrZXlvZiBUOw0KICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaW5jbHVkZXMoa2V5KSkgew0KICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gdmFsdWU7DQogICAgICAgICAgICAgICAgc2F2ZVN0YXRlKCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFByb3BlcnR5ICcke1N0cmluZyhwcm9wKX0nIGlzIG5vdCBtYW5hZ2VkIGJ5IHRoaXMgc3RhdGVgKTsNCiAgICAgICAgfQ0KICAgIH0pIGFzIFBpY2s8VCwgdHlwZW9mIHByb3BlcnRpZXNbbnVtYmVyXT47DQoNCiAgICAvLyDliqDovb3nirbmgIENCiAgICBmdW5jdGlvbiBsb2FkU3RhdGUoKSB7DQogICAgICAgIGlmICghc3RhdGVLZXkpIHJldHVybjsNCiAgICAgICAgY29uc3Qgc3RvcmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oc3RhdGVLZXkpOw0KICAgICAgICBpZiAoc3RvcmVkKSB7DQogICAgICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHN0b3JlZCk7DQogICAgICAgICAgICBwcm9wZXJ0aWVzLmZvckVhY2goKHByb3ApID0+IHsNCiAgICAgICAgICAgICAgICBpZiAocHJvcCBpbiBwYXJzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgaW50ZXJuYWxTdGF0ZVtwcm9wXSA9IHBhcnNlZFtwcm9wXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIOS/neWtmOeKtuaAgQ0KICAgIGZ1bmN0aW9uIHNhdmVTdGF0ZSgpIHsNCiAgICAgICAgaWYgKCFzdGF0ZUtleSkgcmV0dXJuOw0KICAgICAgICBjb25zdCBwZXJzaXN0U3RhdGU6IFBhcnRpYWw8VD4gPSB7fTsNCiAgICAgICAgcHJvcGVydGllcy5mb3JFYWNoKChwcm9wKSA9PiB7DQogICAgICAgICAgICBwZXJzaXN0U3RhdGVbcHJvcF0gPSBpbnRlcm5hbFN0YXRlW3Byb3BdOw0KICAgICAgICB9KTsNCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RhdGVLZXksIEpTT04uc3RyaW5naWZ5KHBlcnNpc3RTdGF0ZSkpOw0KICAgIH0NCg0KICAgIC8vIOWKoOi9veWIneWni+eKtuaAgQ0KICAgIGxvYWRTdGF0ZSgpOw0KDQogICAgcmV0dXJuIHN0YXRlOw0KfQ0KDQovLy8gYnJlYWsgdGV4dCBpbnRvIHBpZWNlcyBieSBnaXZlbiByZWdleCBtYXRjaGVycw0KLy8vIGVhY2ggcGllY2UgaXMgYXR0YWNoZWQgd2l0aCBhIGNhdGVnb3J5DQovLy8gcmV0dXJuOiB7Y29udGVudCwgY2F0ZWdvcnl9W10gdGhhdCBjb3ZlcnMgdGhlIHdob2xlIHRleHQNCmV4cG9ydCBmdW5jdGlvbiBzZWdtZW50QnlSZWdleCh0ZXh0OiBzdHJpbmcsIGhjOiBbUmVnRXhwLCBzdHJpbmddW10pOiB7Y29udGVudDogc3RyaW5nLCBjYXRlZ29yeTogc3RyaW5nfVtdIHsNCiAgICBjb25zdCBtYXRjaGVzOiB7IGluZGV4OiBudW1iZXI7IGxlbmd0aDogbnVtYmVyOyBjb250ZW50OiBzdHJpbmc7IGNhdGVnb3J5OiBzdHJpbmcgfVtdID0gW107DQoNCiAgICAvLyDmlLbpm4bmiYDmnInljLnphY3pobnvvIzmjInnhafkvJjlhYjnuqfku47pq5jliLDkvY7lpITnkIYNCiAgICBmb3IgKGNvbnN0IFtyZSwgY2F0ZWdvcnldIG9mIGhjKSB7DQogICAgICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgdGV4dC5tYXRjaEFsbChyZSkpIHsNCiAgICAgICAgICAgIGlmIChtYXRjaC5pbmRleCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hTdGFydCA9IG1hdGNoLmluZGV4Ow0KICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoRW5kID0gbWF0Y2hTdGFydCArIG1hdGNoLmxlbmd0aDsNCg0KICAgICAgICAgICAgICAgIC8vIOajgOafpeaYr+WQpuS4juW3suacieWMuemFjemhuemHjeWPoA0KICAgICAgICAgICAgICAgIGxldCBvdmVybGFwID0gZmFsc2U7DQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBleGlzdGluZ01hdGNoIG9mIG1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdTdGFydCA9IGV4aXN0aW5nTWF0Y2guaW5kZXg7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRW5kID0gZXhpc3RpbmdTdGFydCArIGV4aXN0aW5nTWF0Y2gubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICBpZiAoKG1hdGNoU3RhcnQgPCBleGlzdGluZ0VuZCAmJiBtYXRjaEVuZCA+IGV4aXN0aW5nU3RhcnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvdmVybGFwID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLy8g5aaC5p6c5rKh5pyJ6YeN5Y+g77yM5re75Yqg5Yiw5Yy56YWN6aG55YiX6KGoDQogICAgICAgICAgICAgICAgaWYgKCFvdmVybGFwKSB7DQogICAgICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaCh7IGluZGV4OiBtYXRjaC5pbmRleCwgbGVuZ3RoOiBtYXRjaFswXS5sZW5ndGgsIGNvbnRlbnQ6IG1hdGNoWzBdLCBjYXRlZ29yeSB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyDmjIkgYGluZGV4YCDku47lsI/liLDlpKfmjpLluo/vvIznoa7kv53ljLnphY3pobrluo/mraPnoa4NCiAgICBtYXRjaGVzLnNvcnQoKGEsIGIpID0+IGEuaW5kZXggLSBiLmluZGV4KTsNCiAgICBjb25zb2xlLmxvZyhtYXRjaGVzKQ0KICAgIA0KICAgIC8vIHJ1biB0aHJvdWdoIHRoZSB0ZXh0IGFuZCBjcmVhdGUgcGllY2VzDQogICAgY29uc3QgcGllY2VzOiB7IGNvbnRlbnQ6IHN0cmluZywgY2F0ZWdvcnk6IHN0cmluZyB9W10gPSBbXTsNCiAgICBsZXQgbGFzdEluZGV4ID0gMDsNCiAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHsNCiAgICAgICAgY29uc3QgeyBpbmRleCwgbGVuZ3RoLCBjb250ZW50LCBjYXRlZ29yeSB9ID0gbWF0Y2g7DQogICAgICAgIGlmIChsYXN0SW5kZXggPCBpbmRleCkgew0KICAgICAgICAgICAgcGllY2VzLnB1c2goe2NvbnRlbnQ6IHRleHQuc2xpY2UobGFzdEluZGV4LCBpbmRleCksIGNhdGVnb3J5OiAnJ30pOw0KICAgICAgICB9DQogICAgICAgIHBpZWNlcy5wdXNoKHtjb250ZW50LCBjYXRlZ29yeX0pOw0KICAgICAgICBsYXN0SW5kZXggPSBpbmRleCArIGxlbmd0aDsNCiAgICB9DQogICAgaWYgKGxhc3RJbmRleCA8IHRleHQubGVuZ3RoKSB7DQogICAgICAgIHBpZWNlcy5wdXNoKHtjb250ZW50OiB0ZXh0LnNsaWNlKGxhc3RJbmRleCksIGNhdGVnb3J5OiAnJ30pOw0KICAgIH0NCiAgICByZXR1cm4gcGllY2VzOw0KfQ0KDQovLy8gaGlnaGxpZ2h0IGpzb24gdGV4dCB3aXRoIHRoZSBmb2xsb3dpbmcgY29uc3RydWN0czoNCi8vLyAtIGtleTogImtleSI6DQovLy8gLSBzdHJpbmc6ICJzdHJpbmciDQovLy8gLSBudW1iZXI6IDEyMw0KLy8vIC0gYm9vbGVhbjogdHJ1ZS9mYWxzZQ0KLy8vIC0gbnVsbDogbnVsbA0KLy8vIC0gcHVuY3R1YXRpb246IHssIH0sIFssIF0sIDosICwNCmV4cG9ydCBmdW5jdGlvbiBzZWdtZW50SnNvbih0ZXh0OiBzdHJpbmcpOiB7Y29udGVudDogc3RyaW5nLCBjYXRlZ29yeTogJ2tleScgfCAnc3RyaW5nJyB8ICdudW1iZXInIHwgJ3RydWUnIHwgJ2ZhbHNlJyB8ICdudWxsJyB8ICdwdW5jdHVhdGlvbicgfCAnJ31bXSB7DQogICAgcmV0dXJuIHNlZ21lbnRCeVJlZ2V4KHRleHQsIFsNCiAgICAgICAgWy8iW14iXSsiOi9nLCAna2V5J10sDQogICAgICAgIFsvIig/OlteIlxcXXxcXC4pKiIvZywgJ3N0cmluZyddLCAvLyDmlK/mjIHovazkuYnnmoTlrZfnrKbkuLLljLnphY0NCiAgICAgICAgWy9cZCsvZywgJ251bWJlciddLA0KICAgICAgICBbL3RydWUvZywgJ3RydWUnXSwNCiAgICAgICAgWy9mYWxzZS9nLCAnZmFsc2UnXSwNCiAgICAgICAgWy9udWxsL2csICdudWxsJ10sDQogICAgICAgIFsvW3t9W1xdOixdL2csICdwdW5jdHVhdGlvbiddLA0KICAgIF0pIGFzIHsNCiAgICAgICAgY29udGVudDogc3RyaW5nLA0KICAgICAgICBjYXRlZ29yeTogJ2tleScgfCAnc3RyaW5nJyB8ICdudW1iZXInIHwgJ3RydWUnIHwgJ2ZhbHNlJyB8ICdudWxsJyB8ICdwdW5jdHVhdGlvbicgfCAnJw0KICAgIH1bXQ0KfQ0KDQovKiogZ2V0IHRoZSBkYXRlIGJvdW5kYXJpZXMgZm9yIGEgZ2l2ZW4gZGF0ZSBhbmQgdHlwZQ0KICogIEBleGFtcGxlIGdldERhdGVCb3VuZGFyaWVzKG5ldyBEYXRlKCksICd3ZWVrJywgMSkgLy8gZ2V0IHRoZSBuZXh0IHdlZWsgYm91bmRhcmllcw0KICogIEBleGFtcGxlIGdldERhdGVCb3VuZGFyaWVzKG5ldyBEYXRlKCksICd3ZWVrJywgLTEpIC8vIGdldCB0aGUgbGFzdCB3ZWVrIGJvdW5kYXJpZXMNCiAqICBAZXhhbXBsZSBnZXREYXRlQm91bmRhcmllcyhuZXcgRGF0ZSgpLCAnbW9udGgnLCAwKSAvLyBnZXQgY3VycmVudCBtb250aCBib3VuZGFyaWVzDQogKi8NCmV4cG9ydCBmdW5jdGlvbiBnZXREYXRlQm91bmRhcmllcyh0OiBEYXRlLCB0eXBlOiAnd2VlaycgfCAnbW9udGgnIHwgJ2RheScgfCAneWVhcicsIG9mZnNldDogbnVtYmVyID0gMCk6IHsgc3RhcnQ6IERhdGUsIGVuZDogRGF0ZSB9IHsNCiAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKHQpOw0KICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKHQpOw0KDQogICAgc3dpdGNoICh0eXBlKSB7DQogICAgICAgIGNhc2UgJ3dlZWsnOg0KICAgICAgICAgICAgY29uc3QgZGF5ID0gc3RhcnQuZ2V0RGF5KCk7DQogICAgICAgICAgICBzdGFydC5zZXREYXRlKHN0YXJ0LmdldERhdGUoKSAtIChkYXkgPT09IDAgPyA2IDogZGF5IC0gMSkgKyBvZmZzZXQgKiA3KTsNCiAgICAgICAgICAgIGVuZC5zZXREYXRlKHN0YXJ0LmdldERhdGUoKSArIDYpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ21vbnRoJzoNCiAgICAgICAgICAgIHN0YXJ0LnNldE1vbnRoKHN0YXJ0LmdldE1vbnRoKCkgKyBvZmZzZXQsIDEpOw0KICAgICAgICAgICAgZW5kLnNldE1vbnRoKHN0YXJ0LmdldE1vbnRoKCkgKyAxLCAwKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdkYXknOg0KICAgICAgICAgICAgc3RhcnQuc2V0RGF0ZShzdGFydC5nZXREYXRlKCkgKyBvZmZzZXQpOw0KICAgICAgICAgICAgZW5kLnNldERhdGUoc3RhcnQuZ2V0RGF0ZSgpKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICd5ZWFyJzoNCiAgICAgICAgICAgIHN0YXJ0LnNldEZ1bGxZZWFyKHN0YXJ0LmdldEZ1bGxZZWFyKCkgKyBvZmZzZXQsIDAsIDEpOw0KICAgICAgICAgICAgZW5kLnNldEZ1bGxZZWFyKHN0YXJ0LmdldEZ1bGxZZWFyKCksIDExLCAzMSk7DQogICAgICAgICAgICBicmVhazsNCiAgICB9DQoNCiAgICBzdGFydC5zZXRIb3VycygwLCAwLCAwLCAwKTsNCiAgICBlbmQuc2V0SG91cnMoMjMsIDU5LCA1OSwgOTk5KTsNCg0KICAgIHJldHVybiB7IHN0YXJ0LCBlbmQgfTsNCn0NCg0KLyoqIFRoaXMgZnVuY3Rpb24gZml4ZXMgdGhlIGJ1ZyBpbiBEYXRlIHRoYXQgd2hlbiB0aW1lIHBhcnQgaXQncyBub3QgZ2l2ZW4sIGl0IA0KICAgIHdpbGwgY29uc3RydWN0IFVUQyBkYXRlIGluc3RlYWQgb2YgbG9jYWwgZGF0ZS4NCiAgICBAc2VlIGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vc2VhcmNoP3E9ZGF0ZS1vbmx5K2Zvcm1zK2FyZStpbnRlcnByZXRlZCthcythK1VUQyt0aW1lDQoqLw0KZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRGF0ZShzOiBzdHJpbmcpIDogRGF0ZSB7DQogICAgaWYgKCFzLmluY2x1ZGVzKCc6JykpIHsNCiAgICAgICAgcyA9IHMgKyAnVDAwOjAwOjAwJw0KICAgIH0NCiAgICByZXR1cm4gbmV3IERhdGUocykNCn0NCg0KLyoqIHJlcGxhY2UgaHRtbCB0ZW1wbGF0ZQ0KICogIHRoaXMgZnVuY3Rpb24gcmVwbGFjZSB0aGUgZm9sbG93aW5nIHdpdGggdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgaW4gdGhlIHJlcGxhY2VtZW50cyBvYmplY3Q6DQogKiAgPCEtLSB7e2tleX19IEJlZ2luIC0tPg0KICAgIC4uLg0KICAgIDwhLS0ge3trZXl9fSBFbmQgLS0+DQogKi8NCmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlSHRtbFRlbXBsYXRlKHRlbXBsYXRlOiBzdHJpbmcsIHJlcGxhY2VtZW50czogUmVjb3JkPHN0cmluZywgc3RyaW5nPik6IHN0cmluZyB7DQogICAgY29uc3QgcmVnZXggPSAvPCEtLVxzKnt7KC4qPyl9fVxzKkJlZ2luXHMqLS0+KFtcc1xTXSo/KTwhLS1ccyp7e1wxfX1ccypFbmRccyotLT4vZzsNCiAgICByZXR1cm4gdGVtcGxhdGUucmVwbGFjZShyZWdleCwgKG1hdGNoLCBrZXkpID0+IHsNCiAgICAgICAgcmV0dXJuIHJlcGxhY2VtZW50c1trZXldIHx8IG1hdGNoOw0KICAgIH0pOw0KfQ0KDQpleHBvcnQgdHlwZSBUb2tlbkluZm8gPSB7DQogICAgYXVkOiBzdHJpbmc7DQogICAgdXBuOiBzdHJpbmc7DQogICAgZXhwOiBudW1iZXI7DQogICAgc2NwPzogc3RyaW5nOw0KfQ0KDQpleHBvcnQgZnVuY3Rpb24gZGVjb2RlSnd0KHRva2VuOiBzdHJpbmcpOiB7IHJhdzogc3RyaW5nLCB0aTogVG9rZW5JbmZvLCBpc0V4cGlyZWQ6IGJvb2xlYW4gfSB7DQogICAgY29uc3QgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpOw0KICAgIGlmIChwYXJ0cy5sZW5ndGggIT09IDMpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdKV1QgbXVzdCBoYXZlIDMgcGFydHMnKTsNCiAgICB9DQoNCiAgICAvLyBjb252ZXJ0IGJhc2U2NHVybCB0byBiYXNlNjQNCiAgICBjb25zdCBiYXNlNjRVcmwgPSBwYXJ0c1sxXS5yZXBsYWNlKC8tL2csICcrJykucmVwbGFjZSgvXy9nLCAnLycpOw0KICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnBhcnNlKGF0b2IoYmFzZTY0VXJsKSk7DQoNCiAgICBjb25zdCB0aSA9IHBheWxvYWQgYXMgVG9rZW5JbmZvOw0KICAgIC8vIGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBleHBpcmVkDQogICAgY29uc3QgaXNFeHBpcmVkID0gdGkuZXhwIDwgTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7DQogICAgcmV0dXJuIHsNCiAgICAgICAgcmF3OiB0b2tlbiwNCiAgICAgICAgdGksDQogICAgICAgIGlzRXhwaXJlZCwNCiAgICB9DQp9DQo="
}
